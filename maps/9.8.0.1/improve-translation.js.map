{"version":3,"file":"../../popup/improve-translation.js","names":["$","document","querySelector","bind","addEventListener","window","history","back","twpConfig","setTargetLanguage","value","set","chrome","tabs","query","active","currentWindow","sendMessage","id","action","sourceLanguage","dontSortResults","targetLanguage","response","checkedLastError","onReady","get","langs","twpLang","getLanguageList","langsSorted","i","push","sort","a","b","localeCompare","eAllLangs","selectTargetLanguage","forEach","option","createElement","textContent","appendChild","selectOriginalLanguage","eRecentsLangs","disableDarkMode","el","setAttribute","head","enableDarkMode","remove","matchMedia","matches"],"sources":["improve-translation.js"],"sourcesContent":["\"use strict\";\r\n\r\nlet $ = document.querySelector.bind(document);\r\n\r\n$(\"#btnClose\").addEventListener(\"click\", () => {\r\n  window.history.back();\r\n});\r\n\r\n$(\"#btnApply\").addEventListener(\"click\", () => {\r\n  twpConfig.setTargetLanguage($(\"#selectTargetLanguage\").value, true);\r\n  twpConfig.set(\"dontSortResults\", $(\"#dontSortResults\").value);\r\n\r\n  chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\r\n    chrome.tabs.sendMessage(\r\n      tabs[0].id,\r\n      {\r\n        action: \"improveTranslation\",\r\n        sourceLanguage: $(\"#selectOriginalLanguage\").value,\r\n        dontSortResults: $(\"#dontSortResults\").value,\r\n        targetLanguage: $(\"#selectTargetLanguage\").value,\r\n      },\r\n      (response) => {\r\n        checkedLastError();\r\n        window.history.back();\r\n      }\r\n    );\r\n  });\r\n});\r\n\r\ntwpConfig.onReady(function () {\r\n  $(\"#dontSortResults\").value = twpConfig.get(\"dontSortResults\");\r\n  chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\r\n    chrome.tabs.sendMessage(\r\n      tabs[0].id,\r\n      { action: \"getCurrentSourceLanguage\" },\r\n      (sourceLanguage) => {\r\n        checkedLastError();\r\n        $(\"#selectOriginalLanguage\").value = sourceLanguage\r\n          ? sourceLanguage\r\n          : \"auto\";\r\n      }\r\n    );\r\n  });\r\n\r\n  let langs = twpLang.getLanguageList();\r\n\r\n  const langsSorted = [];\r\n\r\n  for (const i in langs) {\r\n    langsSorted.push([i, langs[i]]);\r\n  }\r\n\r\n  langsSorted.sort(function (a, b) {\r\n    return a[1].localeCompare(b[1]);\r\n  });\r\n\r\n  const eAllLangs = selectTargetLanguage.querySelector('[name=\"all\"]');\r\n  langsSorted.forEach((value) => {\r\n    const option = document.createElement(\"option\");\r\n    option.value = value[0];\r\n    option.textContent = value[1];\r\n    eAllLangs.appendChild(option);\r\n  });\r\n\r\n  const selectOriginalLanguage = $(\"#selectOriginalLanguage\");\r\n  langsSorted.forEach((value) => {\r\n    const option = document.createElement(\"option\");\r\n    option.value = value[0];\r\n    option.textContent = value[1];\r\n    selectOriginalLanguage.appendChild(option);\r\n  });\r\n\r\n  const eRecentsLangs = selectTargetLanguage.querySelector('[name=\"targets\"]');\r\n  for (const value of twpConfig.get(\"targetLanguages\")) {\r\n    const option = document.createElement(\"option\");\r\n    option.value = value;\r\n    option.textContent = langs[value];\r\n    eRecentsLangs.appendChild(option);\r\n  }\r\n  selectTargetLanguage.value = twpConfig.get(\"targetLanguages\")[0];\r\n\r\n  function disableDarkMode() {\r\n    if (!$(\"#lightModeElement\")) {\r\n      const el = document.createElement(\"style\");\r\n      el.setAttribute(\"id\", \"lightModeElement\");\r\n      el.setAttribute(\"rel\", \"stylesheet\");\r\n      el.textContent = `\r\n            body {\r\n                color: rgb(0, 0, 0);\r\n                background-color: rgb(224, 224, 224);\r\n            }\r\n  \r\n            .select, #btnApply {\r\n                color: black;\r\n                background-color: rgba(0, 0, 0, 0.2);\r\n            }\r\n            \r\n            .select:hover, #btnApply:hover {\r\n                background-color: rgba(0, 0, 0, 0.4);\r\n            }\r\n  \r\n            .mdiv, .md {\r\n                background-color: rgb(0, 0, 0);\r\n            }\r\n            `;\r\n      document.head.appendChild(el);\r\n    }\r\n  }\r\n\r\n  function enableDarkMode() {\r\n    if ($(\"#lightModeElement\")) {\r\n      $(\"#lightModeElement\").remove();\r\n    }\r\n  }\r\n\r\n  switch (twpConfig.get(\"darkMode\")) {\r\n    case \"auto\":\r\n      if (matchMedia(\"(prefers-color-scheme: dark)\").matches) {\r\n        enableDarkMode();\r\n      } else {\r\n        disableDarkMode();\r\n      }\r\n      break;\r\n    case \"yes\":\r\n      enableDarkMode();\r\n      break;\r\n    case \"no\":\r\n      disableDarkMode();\r\n      break;\r\n    default:\r\n      break;\r\n  }\r\n});\r\n"],"mappings":"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"}