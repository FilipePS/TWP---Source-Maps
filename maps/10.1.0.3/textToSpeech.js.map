{"version":3,"file":"../../background/textToSpeech.js","names":["textToSpeech","BingHelper","IG","_IG","_","IID","_IID","key","_key","token","_token","findAuth","_promise","Promise","resolve","updateBingAuth","_lastRequestTime","date","Date","setMinutes","getMinutes","_notFound","getTime","now","http","XMLHttpRequest","open","send","onload","e","responseText","length","Error","match","abhStartText","abhStartIndex","indexOf","abhEndIndex","abhText","slice","abh","JSON","parse","onerror","onabort","ontimeout","console","error","finally","getLanguageData","language","replacements","search","replace","forEach","r","languageData","locale","gender","voice","data","find","AudioAmplifier","constructor","sources","window","audioCtx","AudioContext","suspend","gainNode","createGain","gain","value","connect","destination","amplify","audio","source","mediaElement","resume","createMediaElementSource","push","setVolume","volume","Service","serviceName","baseURL","xhrMethod","cbGetExtraParameters","cbGetRequestBody","audios","Map","audioSpeed","audioAmplifier","getRequests","fullText","fullTextSplitted","trim","split","word","requests","requestString","text","makeRequest","targetLanguage","reject","xhr","reader","FileReader","onloadend","result","readAsDataURL","response","responseType","setRequestHeader","promises","requestText","audioKey","join","get","then","Audio","set","catch","all","play","map","stopAll","Array","playAll","currentIndex","playbackRate","addEventListener","once","HTMLAudioElement","setAudioSpeed","speed","setAudioVolume","pause","isNaN","duration","isFinite","currentTime","googleService","getExtraParameters","encodeURIComponent","bingService","getRequestBody","domParser","DOMParser","doc","parseFromString","querySelector","setAttribute","textContent","params","URLSearchParams","append","XMLSerializer","serializeToString","toString","chrome","runtime","onMessage","addListener","request","sender","sendResponse","action","twpConfig","onReady","_proxyServers$google2","onChanged","name","newvalue","_proxyServers$google","proxyServers","google","ttsServer","url","URL","host"],"sources":["textToSpeech.js"],"sourcesContent":["\"use strict\";\r\n\r\nconst textToSpeech = (function () {\r\n  const textToSpeech = {};\r\n\r\n  class BingHelper {\r\n    /** @type {number} */\r\n    static #lastRequestTime = null;\r\n    /** @type {string} */\r\n    static #IG = null;\r\n    /** @type {string} */\r\n    static #IID = null;\r\n    /** @type {number} */\r\n    static #key = null;\r\n    /** @type {string} */\r\n    static #token = null;\r\n    /** @type {boolean} */\r\n    static #notFound = false;\r\n    /** @type {Promise<void>} */\r\n    static #promise = null;\r\n\r\n    static get IG() {\r\n      return BingHelper.#IG;\r\n    }\r\n    static get IID() {\r\n      return BingHelper.#IID;\r\n    }\r\n    static get key() {\r\n      return BingHelper.#key;\r\n    }\r\n    static get token() {\r\n      return BingHelper.#token;\r\n    }\r\n\r\n    /**\r\n     * Find the SID (IID and IG) of Bing Translator. The SID value is used in translation requests.\r\n     * @returns {Promise<void>}\r\n     */\r\n    static async findAuth() {\r\n      if (BingHelper.#promise) return await BingHelper.#promise;\r\n\r\n      BingHelper.#promise = new Promise((resolve) => {\r\n        let updateBingAuth = false;\r\n        if (BingHelper.#lastRequestTime) {\r\n          const date = new Date();\r\n          if (BingHelper.#IG) {\r\n            date.setMinutes(date.getMinutes() - 30);\r\n          } else if (BingHelper.#notFound) {\r\n            date.setMinutes(date.getMinutes() - 5);\r\n          } else {\r\n            date.setMinutes(date.getMinutes() - 2);\r\n          }\r\n          if (date.getTime() > BingHelper.#lastRequestTime) {\r\n            updateBingAuth = true;\r\n          }\r\n        } else {\r\n          updateBingAuth = true;\r\n        }\r\n\r\n        if (updateBingAuth) {\r\n          BingHelper.#lastRequestTime = Date.now();\r\n\r\n          const http = new XMLHttpRequest();\r\n          http.open(\"GET\", \"https://www.bing.com/translator\");\r\n          http.send();\r\n          http.onload = (e) => {\r\n            try {\r\n              if (!(http.responseText && http.responseText.length > 1)) {\r\n                throw new Error(\"Not found\");\r\n              }\r\n\r\n              const responseText = http.responseText;\r\n              const IG = responseText.match(/IG:\"([^\"]+)\"/)[1];\r\n              const IID = responseText.match(/data\\-iid\\=\"([^\"]+)\"/)[1];\r\n\r\n              const abhStartText = \"params_AbusePreventionHelper = [\";\r\n              const abhStartIndex = responseText.indexOf(abhStartText);\r\n              if (abhStartIndex === -1) {\r\n                throw new Error(\"Not found 2\");\r\n              }\r\n              const abhEndIndex = responseText.indexOf(\"]\", abhStartIndex);\r\n              if (abhEndIndex === -1) {\r\n                throw new Error(\"Not found 3\");\r\n              }\r\n              const abhText = responseText.slice(\r\n                abhStartIndex + abhStartText.length - 1,\r\n                abhEndIndex + 1\r\n              );\r\n              const abh = JSON.parse(abhText);\r\n              const key = abh[0];\r\n              const token = abh[1];\r\n\r\n              BingHelper.#IG = IG;\r\n              BingHelper.#IID = IID;\r\n              BingHelper.#key = key;\r\n              BingHelper.#token = token;\r\n              BingHelper.#notFound = false;\r\n            } catch (e) {\r\n              BingHelper.#notFound = true;\r\n            } finally {\r\n              resolve();\r\n            }\r\n          };\r\n          http.onerror =\r\n            http.onabort =\r\n            http.ontimeout =\r\n              (e) => {\r\n                console.error(e);\r\n                resolve();\r\n              };\r\n        } else {\r\n          resolve();\r\n        }\r\n      });\r\n\r\n      BingHelper.#promise.finally(() => {\r\n        BingHelper.#promise = null;\r\n      });\r\n\r\n      return await BingHelper.#promise;\r\n    }\r\n\r\n    /**\r\n     * @typedef {Object} LanguageData\r\n     * @property {String} language\r\n     * @property {String} locale\r\n     * @property {String} gender\r\n     * @property {String} voice\r\n     */\r\n\r\n    /**\r\n     * Get the language data for the language.\r\n     * @param {string} language\r\n     * @returns {LanguageData} languageData\r\n     */\r\n    static getLanguageData(language) {\r\n      /** @type {{search: string, replace: string}[]} */\r\n      // prettier-ignore\r\n      const replacements = [\r\n        { search: \"zh-CN\", replace: \"zh-Hans\", },\r\n        { search: \"zh-TW\", replace: \"zh-Hant\", },\r\n        { search: \"tl\", replace: \"fil\", },\r\n        { search: \"hmn\", replace: \"mww\", },\r\n        { search: \"ku\", replace: \"kmr\", },\r\n        { search: \"ckb\", replace: \"ku\", },\r\n        { search: \"mn\", replace: \"mn-Cyrl\", },\r\n        { search: \"no\", replace: \"nb\", },\r\n        { search: \"lg\", replace: \"lug\", },\r\n        { search: \"sr\", replace: \"sr-Cyrl\", },\r\n      ];\r\n      replacements.forEach((r) => {\r\n        if (language === r.search) {\r\n          language = r.replace;\r\n        }\r\n      });\r\n\r\n      // prettier-ignore\r\n      const languageData = [\r\n        { language: 'af', locale: 'af-ZA', gender: 'Female', voice: 'af-ZA-AdriNeural' },\r\n        { language: 'am', locale: 'am-ET', gender: 'Female', voice: 'am-ET-MekdesNeural' },\r\n        { language: 'ar', locale: 'ar-SA', gender: 'Male', voice: 'ar-SA-HamedNeural' },\r\n        { language: 'bn', locale: 'bn-IN', gender: 'Female', voice: 'bn-IN-TanishaaNeural' },\r\n        { language: 'bg', locale: 'bg-BG', gender: 'Male', voice: 'bg-BG-BorislavNeural' },\r\n        { language: 'ca', locale: 'ca-ES', gender: 'Female', voice: 'ca-ES-JoanaNeural' },\r\n        { language: 'cs', locale: 'cs-CZ', gender: 'Male', voice: 'cs-CZ-AntoninNeural' },\r\n        { language: 'cy', locale: 'cy-GB', gender: 'Female', voice: 'cy-GB-NiaNeural' },\r\n        { language: 'da', locale: 'da-DK', gender: 'Female', voice: 'da-DK-ChristelNeural' },\r\n        { language: 'de', locale: 'de-DE', gender: 'Female', voice: 'de-DE-KatjaNeural' },\r\n        { language: 'el', locale: 'el-GR', gender: 'Male', voice: 'el-GR-NestorasNeural' },\r\n        { language: 'en', locale: 'en-US', gender: 'Female', voice: 'en-US-AriaNeural' },\r\n        { language: 'es', locale: 'es-ES', gender: 'Female', voice: 'es-ES-ElviraNeural' },\r\n        { language: 'et', locale: 'et-EE', gender: 'Female', voice: 'et-EE-AnuNeural' },\r\n        { language: 'fa', locale: 'fa-IR', gender: 'Female', voice: 'fa-IR-DilaraNeural' },\r\n        { language: 'fi', locale: 'fi-FI', gender: 'Female', voice: 'fi-FI-NooraNeural' },\r\n        { language: 'fr', locale: 'fr-FR', gender: 'Female', voice: 'fr-FR-DeniseNeural' },\r\n        { language: 'fr-CA', locale: 'fr-CA', gender: 'Female', voice: 'fr-CA-SylvieNeural' },\r\n        { language: 'ga', locale: 'ga-IE', gender: 'Female', voice: 'ga-IE-OrlaNeural' },\r\n        { language: 'gu', locale: 'gu-IN', gender: 'Female', voice: 'gu-IN-DhwaniNeural' },\r\n        { language: 'he', locale: 'he-IL', gender: 'Male', voice: 'he-IL-AvriNeural' },\r\n        { language: 'hi', locale: 'hi-IN', gender: 'Female', voice: 'hi-IN-SwaraNeural' },\r\n        { language: 'hr', locale: 'hr-HR', gender: 'Male', voice: 'hr-HR-SreckoNeural' },\r\n        { language: 'hu', locale: 'hu-HU', gender: 'Male', voice: 'hu-HU-TamasNeural' },\r\n        { language: 'id', locale: 'id-ID', gender: 'Male', voice: 'id-ID-ArdiNeural' },\r\n        { language: 'is', locale: 'is-IS', gender: 'Female', voice: 'is-IS-GudrunNeural' },\r\n        { language: 'it', locale: 'it-IT', gender: 'Male', voice: 'it-IT-DiegoNeural' },\r\n        { language: 'ja', locale: 'ja-JP', gender: 'Female', voice: 'ja-JP-NanamiNeural' },\r\n        { language: 'kk', locale: 'kk-KZ', gender: 'Female', voice: 'kk-KZ-AigulNeural' },\r\n        { language: 'km', locale: 'km-KH', gender: 'Female', voice: 'km-KH-SreymomNeural' },\r\n        { language: 'kn', locale: 'kn-IN', gender: 'Female', voice: 'kn-IN-SapnaNeural' },\r\n        { language: 'ko', locale: 'ko-KR', gender: 'Female', voice: 'ko-KR-SunHiNeural' },\r\n        { language: 'lo', locale: 'lo-LA', gender: 'Female', voice: 'lo-LA-KeomanyNeural' },\r\n        { language: 'lv', locale: 'lv-LV', gender: 'Female', voice: 'lv-LV-EveritaNeural' },\r\n        { language: 'lt', locale: 'lt-LT', gender: 'Female', voice: 'lt-LT-OnaNeural' },\r\n        { language: 'mk', locale: 'mk-MK', gender: 'Female', voice: 'mk-MK-MarijaNeural' },\r\n        { language: 'ml', locale: 'ml-IN', gender: 'Female', voice: 'ml-IN-SobhanaNeural' },\r\n        { language: 'mr', locale: 'mr-IN', gender: 'Female', voice: 'mr-IN-AarohiNeural' },\r\n        { language: 'ms', locale: 'ms-MY', gender: 'Male', voice: 'ms-MY-OsmanNeural' },\r\n        { language: 'mt', locale: 'mt-MT', gender: 'Female', voice: 'mt-MT-GraceNeural' },\r\n        { language: 'my', locale: 'my-MM', gender: 'Female', voice: 'my-MM-NilarNeural' },\r\n        { language: 'nl', locale: 'nl-NL', gender: 'Female', voice: 'nl-NL-ColetteNeural' },\r\n        { language: 'nb', locale: 'nb-NO', gender: 'Female', voice: 'nb-NO-PernilleNeural' },\r\n        { language: 'pl', locale: 'pl-PL', gender: 'Female', voice: 'pl-PL-ZofiaNeural' },\r\n        { language: 'ps', locale: 'ps-AF', gender: 'Female', voice: 'ps-AF-LatifaNeural' },\r\n        { language: 'pt', locale: 'pt-BR', gender: 'Female', voice: 'pt-BR-FranciscaNeural' },\r\n        { language: 'pt-PT', locale: 'pt-PT', gender: 'Female', voice: 'pt-PT-FernandaNeural' },\r\n        { language: 'ro', locale: 'ro-RO', gender: 'Male', voice: 'ro-RO-EmilNeural' },\r\n        { language: 'ru', locale: 'ru-RU', gender: 'Female', voice: 'ru-RU-DariyaNeural' },\r\n        { language: 'sk', locale: 'sk-SK', gender: 'Male', voice: 'sk-SK-LukasNeural' },\r\n        { language: 'sl', locale: 'sl-SI', gender: 'Male', voice: 'sl-SI-RokNeural' },\r\n        { language: 'sr-Cyrl', locale: 'sr-RS', gender: 'Female', voice: 'sr-RS-SophieNeural' },\r\n        { language: 'sv', locale: 'sv-SE', gender: 'Female', voice: 'sv-SE-SofieNeural' },\r\n        { language: 'ta', locale: 'ta-IN', gender: 'Female', voice: 'ta-IN-PallaviNeural' },\r\n        { language: 'te', locale: 'te-IN', gender: 'Male', voice: 'te-IN-ShrutiNeural' },\r\n        { language: 'th', locale: 'th-TH', gender: 'Male', voice: 'th-TH-NiwatNeural' },\r\n        { language: 'tr', locale: 'tr-TR', gender: 'Female', voice: 'tr-TR-EmelNeural' },\r\n        { language: 'uk', locale: 'uk-UA', gender: 'Female', voice: 'uk-UA-PolinaNeural' },\r\n        { language: 'ur', locale: 'ur-IN', gender: 'Female', voice: 'ur-IN-GulNeural' },\r\n        { language: 'uz', locale: 'uz-UZ', gender: 'Female', voice: 'uz-UZ-MadinaNeural' },\r\n        { language: 'vi', locale: 'vi-VN', gender: 'Male', voice: 'vi-VN-NamMinhNeural' },\r\n        { language: 'zh-Hans', locale: 'zh-CN', gender: 'Female', voice: 'zh-CN-XiaoxiaoNeural' },\r\n        { language: 'zh-Hant', locale: 'zh-CN', gender: 'Female', voice: 'zh-CN-XiaoxiaoNeural' },\r\n        { language: 'yue', locale: 'zh-HK', gender: 'Female', voice: 'zh-HK-HiuGaaiNeural' }\r\n      ];\r\n\r\n      const data = languageData.find((data) => data.language === language);\r\n      return data;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @callback Callback_Speech_cbGetExtraParameters\r\n   * @param {string} text\r\n   * @param {string} targetLanguage\r\n   * @return {string} urlParamsString\r\n   */\r\n\r\n  /**\r\n   * @callback Callback_Speech_cbGetRequestBody\r\n   * @param {string} text\r\n   * @param {string} targetLanguage\r\n   * @return {string} requestBody\r\n   */\r\n\r\n  class AudioAmplifier {\r\n    /**\r\n     * Defines the Amplifier class for the text-to-speech service.\r\n     */\r\n    constructor() {\r\n      /** @type {MediaElementAudioSourceNode[]} */\r\n      this.sources = [];\r\n      if (\"AudioContext\" in window) {\r\n        this.audioCtx = new AudioContext();\r\n        this.audioCtx.suspend();\r\n        this.gainNode = this.audioCtx.createGain();\r\n        this.gainNode.gain.value = 1;\r\n        this.gainNode.connect(this.audioCtx.destination);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Amplify the audio.\r\n     * @param {HTMLAudioElement} audio\r\n     */\r\n    async amplify(audio) {\r\n      if (!this.audioCtx) return;\r\n      if (this.sources.find((source) => source.mediaElement === audio)) {\r\n        await this.audioCtx.resume();\r\n        return;\r\n      }\r\n\r\n      const source = this.audioCtx.createMediaElementSource(audio);\r\n      this.sources.push(source);\r\n\r\n      source.connect(this.gainNode);\r\n\r\n      await this.audioCtx.resume();\r\n    }\r\n\r\n    /**\r\n     * Set the volume of the amplifier.\r\n     * @param {number} volume\r\n     */\r\n    setVolume(volume) {\r\n      if (!this.gainNode) return;\r\n      if (volume > 1) {\r\n        this.gainNode.gain.value = volume;\r\n      } else {\r\n        this.gainNode.gain.value = 1;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Suspend the audio context.\r\n     * https://github.com/FilipePS/Traduzir-paginas-web/issues/802\r\n     * @returns {Promise<void>} Promise\\<void\\>\r\n     */\r\n    async suspend() {\r\n      if (this.audioCtx) {\r\n        await this.audioCtx.suspend();\r\n      }\r\n    }\r\n  }\r\n\r\n  class Service {\r\n    /**\r\n     * Defines the Service class for the text-to-speech service.\r\n     * @param {string} serviceName\r\n     * @param {string} baseURL\r\n     * @param {\"GET\" | \"POST\"} xhrMethod\r\n     * @param {Callback_Speech_cbGetExtraParameters} cbGetExtraParameters\r\n     * @param {Callback_Speech_cbGetRequestBody} cbGetRequestBody\r\n     */\r\n    constructor(\r\n      serviceName,\r\n      baseURL,\r\n      xhrMethod,\r\n      cbGetExtraParameters,\r\n      cbGetRequestBody = null\r\n    ) {\r\n      this.serviceName = serviceName;\r\n      this.baseURL = baseURL;\r\n      this.xhrMethod = xhrMethod;\r\n      this.cbGetExtraParameters = cbGetExtraParameters;\r\n      this.cbGetRequestBody = cbGetRequestBody;\r\n\r\n      /** @type {Map<string, HTMLAudioElement>} */\r\n      this.audios = new Map();\r\n      this.audioSpeed = 1.0;\r\n\r\n      this.audioAmplifier = new AudioAmplifier();\r\n    }\r\n\r\n    /**\r\n     * Takes a long text and splits the text into an array of strings. Each string will be less than 170 characters.\r\n     *\r\n     * The goal is not to exceed the quota for text-to-speech services.\r\n     * @param {string} fullText\r\n     * @returns {string[]} requestStrings\r\n     */\r\n    getRequests(fullText) {\r\n      /** @type {string[]} */\r\n      const fullTextSplitted = [];\r\n      fullText\r\n        .trim()\r\n        .split(\" \")\r\n        .forEach((word) => {\r\n          if (word.length > 160) {\r\n            while (word.length > 160) {\r\n              fullTextSplitted.push(word.slice(0, 160));\r\n              word = word.slice(160);\r\n            }\r\n            if (word.trim().length > 0) {\r\n              fullTextSplitted.push(word);\r\n            }\r\n          } else if (word.trim().length > 0) {\r\n            fullTextSplitted.push(word);\r\n          }\r\n        });\r\n\r\n      /** @type {string[]} */\r\n      const requests = [];\r\n      let requestString = \"\";\r\n      for (let text of fullTextSplitted) {\r\n        text += \" \";\r\n        if (requestString.length + text.length < 170) {\r\n          requestString += text;\r\n        } else {\r\n          requests.push(requestString);\r\n          requestString = text;\r\n        }\r\n      }\r\n      if (requestString.trim().length > 0) {\r\n        requests.push(requestString);\r\n        requestString = \"\";\r\n      }\r\n\r\n      return requests;\r\n    }\r\n\r\n    /**\r\n     * Makes the request to the text-to-speech service and returns a promise that resolves with the result of the request.\r\n     *\r\n     * The promise is rejected if there is an error.\r\n     * @param {string} text\r\n     * @param {string} targetLanguage\r\n     * @returns {Promise<any>} Promise\\<blob\\>\r\n     */\r\n    async makeRequest(text, targetLanguage) {\r\n      return await new Promise((resolve, reject) => {\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.onload = (e) => {\r\n          const reader = new FileReader();\r\n          reader.onloadend = () => resolve(reader.result);\r\n          reader.onerror = () => reject();\r\n          reader.readAsDataURL(xhr.response);\r\n        };\r\n        xhr.onerror = (e) => {\r\n          console.error(e);\r\n          reject();\r\n        };\r\n        xhr.open(\r\n          this.xhrMethod,\r\n          this.baseURL + this.cbGetExtraParameters(text, targetLanguage)\r\n        );\r\n        xhr.responseType = \"blob\";\r\n        if (this.cbGetRequestBody) {\r\n          xhr.setRequestHeader(\r\n            \"Content-Type\",\r\n            \"application/x-www-form-urlencoded\"\r\n          );\r\n          xhr.send(this.cbGetRequestBody(text, targetLanguage));\r\n        } else {\r\n          xhr.send();\r\n        }\r\n      });\r\n    }\r\n\r\n    /**\r\n     * Transform text into audio and play then.\r\n     * @param {string} fullText\r\n     * @param {string} targetLanguage\r\n     * @returns {Promise<void>} Promise\\<void\\>\r\n     */\r\n    async textToSpeech(fullText, targetLanguage) {\r\n      if (this.serviceName === \"bing\") {\r\n        await BingHelper.findAuth();\r\n      }\r\n\r\n      const requests = this.getRequests(fullText);\r\n      const promises = [];\r\n\r\n      for (const requestText of requests) {\r\n        const audioKey = [targetLanguage, requestText].join(\", \");\r\n        if (!this.audios.get(audioKey)) {\r\n          promises.push(\r\n            this.makeRequest(requestText, targetLanguage)\r\n              .then(\r\n                /** @type {string} */ (response) => {\r\n                  const audio = new Audio(response);\r\n                  this.audios.set(audioKey, audio);\r\n                  return response;\r\n                }\r\n              )\r\n              .catch((e) => {\r\n                console.error(e);\r\n                return null;\r\n              })\r\n          );\r\n        }\r\n      }\r\n\r\n      await Promise.all(promises);\r\n      return await this.play(\r\n        requests.map((text) =>\r\n          this.audios.get([targetLanguage, text].join(\", \"))\r\n        )\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Play the audio or all the audio in the array.\r\n     * @param {HTMLAudioElement | HTMLAudioElement[]} audios\r\n     */\r\n    async play(audios) {\r\n      this.stopAll();\r\n      const result = await new Promise(async (resolve) => {\r\n        try {\r\n          if (audios instanceof Array) {\r\n            const playAll = async (/** @type {number} */ currentIndex) => {\r\n              this.stopAll();\r\n              const audio = audios[currentIndex];\r\n              if (audio) {\r\n                audio.playbackRate = this.audioSpeed;\r\n                await this.audioAmplifier.amplify(audio);\r\n                audio.play();\r\n                audio.addEventListener(\r\n                  \"ended\",\r\n                  () => {\r\n                    playAll(currentIndex + 1);\r\n                  },\r\n                  { once: true }\r\n                );\r\n              } else {\r\n                resolve();\r\n              }\r\n            };\r\n            playAll(0);\r\n          } else if (audios instanceof HTMLAudioElement) {\r\n            audios.playbackRate = this.audioSpeed;\r\n            await this.audioAmplifier.amplify(audios);\r\n            audios.play();\r\n            audios.addEventListener(\r\n              \"ended\",\r\n              () => {\r\n                resolve();\r\n              },\r\n              { once: true }\r\n            );\r\n          }\r\n        } catch (e) {\r\n          console.error(e);\r\n          resolve();\r\n        }\r\n      });\r\n      await this.audioAmplifier.suspend();\r\n      return result;\r\n    }\r\n\r\n    /**\r\n     * Sets the audio speed\r\n     * @param {number} speed\r\n     */\r\n    setAudioSpeed(speed) {\r\n      this.audioSpeed = speed;\r\n      this.audios.forEach((audio) => {\r\n        audio.playbackRate = this.audioSpeed;\r\n      });\r\n    }\r\n\r\n    /**\r\n     * Sets the audio volume\r\n     * @param {number} volume\r\n     */\r\n    setAudioVolume(volume) {\r\n      this.audios.forEach((audio) => {\r\n        audio.volume = volume > 1 ? 1 : volume;\r\n      });\r\n      this.audioAmplifier.setVolume(volume < 1 ? 1 : volume);\r\n    }\r\n\r\n    /**\r\n     * Pause all audio and reset audio time to start\r\n     */\r\n    stopAll() {\r\n      this.audios.forEach((audio) => {\r\n        audio.pause();\r\n        // If `currentTime` is not `duration` an audio stream will remain active in Firefox\r\n        // https://github.com/FilipePS/Traduzir-paginas-web/issues/802\r\n        if (!isNaN(audio.duration) && isFinite(audio.duration)) {\r\n          audio.currentTime = audio.duration;\r\n        }\r\n      });\r\n      this.audioAmplifier.suspend();\r\n    }\r\n  }\r\n\r\n  // Create a Service instance based on google's text-to-speech service.\r\n  const googleService = new Service(\r\n    \"google\",\r\n    \"https://translate.google.com/translate_tts?ie=UTF-8\",\r\n    \"GET\",\r\n    function getExtraParameters(text, targetLanguage) {\r\n      return `&tl=${targetLanguage}&client=dict-chrome-ex&ttsspeed=0.5&q=${encodeURIComponent(\r\n        text\r\n      )}`;\r\n    }\r\n  );\r\n\r\n  // Create a Service instance based on bings's text-to-speech service.\r\n  const bingService = new Service(\r\n    \"bing\",\r\n    \"https://www.bing.com/tfettts?isVertical=1\",\r\n    \"POST\",\r\n    function getExtraParameters(text, targetLanguage) {\r\n      return `&&IG=${encodeURIComponent(\r\n        BingHelper.IG\r\n      )}&IID=${encodeURIComponent(BingHelper.IID)}.${\"1\"}`;\r\n    },\r\n    function getRequestBody(text, targetLanguage) {\r\n      const languageData = BingHelper.getLanguageData(targetLanguage);\r\n\r\n      const domParser = new DOMParser();\r\n      const doc = domParser.parseFromString(\r\n        `<speak version='1.0' xml:lang=''><voice xml:lang='' xml:gender='' name=''><prosody rate='-20.00%'></prosody></voice></speak>`,\r\n        \"text/xml\"\r\n      );\r\n      doc.querySelector(\"speak\").setAttribute(\"xml:lang\", languageData.locale);\r\n      doc.querySelector(\"voice\").setAttribute(\"xml:lang\", languageData.locale);\r\n      doc\r\n        .querySelector(\"voice\")\r\n        .setAttribute(\"xml:gender\", languageData.gender);\r\n      doc.querySelector(\"voice\").setAttribute(\"xml:name\", languageData.voice);\r\n      doc.querySelector(\"prosody\").textContent = text;\r\n\r\n      const params = new URLSearchParams();\r\n      params.append(\"ssml\", new XMLSerializer().serializeToString(doc));\r\n      params.append(\"token\", BingHelper.token);\r\n      params.append(\"key\", BingHelper.key.toString());\r\n      return params.toString();\r\n    }\r\n  );\r\n\r\n  // Listen for messages coming from contentScript or other scripts.\r\n  chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\r\n    if (request.action === \"textToSpeech\") {\r\n      if (twpConfig.get(\"textToSpeechService\") === \"bing\") {\r\n        bingService\r\n          .textToSpeech(request.text, request.targetLanguage)\r\n          .finally(() => {\r\n            sendResponse();\r\n          });\r\n      } else {\r\n        googleService\r\n          .textToSpeech(request.text, request.targetLanguage)\r\n          .finally(() => {\r\n            sendResponse();\r\n          });\r\n      }\r\n\r\n      return true;\r\n    } else if (request.action === \"stopAudio\") {\r\n      googleService.stopAll();\r\n      bingService.stopAll();\r\n    }\r\n  });\r\n\r\n  // Listen for changes to the audio speed setting and apply it immediately.\r\n  twpConfig.onReady(async () => {\r\n    twpConfig.onChanged((name, newvalue) => {\r\n      if (name === \"ttsSpeed\") {\r\n        googleService.setAudioSpeed(newvalue);\r\n        bingService.setAudioSpeed(newvalue);\r\n      } else if (name === \"ttsVolume\") {\r\n        googleService.setAudioVolume(newvalue);\r\n        bingService.setAudioVolume(newvalue);\r\n      } else if (name === \"proxyServers\") {\r\n        const proxyServers = newvalue;\r\n        if (proxyServers?.google?.ttsServer) {\r\n          const url = new URL(googleService.baseURL);\r\n          url.host = proxyServers.google.ttsServer;\r\n          googleService.baseURL = url.toString();\r\n        } else {\r\n          const url = new URL(googleService.baseURL);\r\n          url.host = \"translate.google.com\";\r\n          googleService.baseURL = url.toString();\r\n        }\r\n      }\r\n    });\r\n\r\n    googleService.setAudioSpeed(twpConfig.get(\"ttsSpeed\"));\r\n    bingService.setAudioSpeed(twpConfig.get(\"ttsSpeed\"));\r\n    googleService.setAudioVolume(twpConfig.get(\"ttsVolume\"));\r\n    bingService.setAudioVolume(twpConfig.get(\"ttsVolume\"));\r\n\r\n    const proxyServers = twpConfig.get(\"proxyServers\");\r\n    if (proxyServers?.google?.ttsServer) {\r\n      const url = new URL(googleService.baseURL);\r\n      url.host = proxyServers.google.ttsServer;\r\n      googleService.baseURL = url.toString();\r\n    }\r\n  });\r\n\r\n  textToSpeech.google = googleService;\r\n\r\n  return textToSpeech;\r\n})();\r\n"],"mappings":"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","ignoreList":[]}