{"version":3,"file":"../contentScript/translateSelected.js","names":["translateSelected","getTabHostName","Promise","resolve","chrome","runtime","sendMessage","action","result","checkedLastError","all","twpConfig","onReady","then","_","tabHostName","gSelectionInfo","prevSelectionInfo","divElement","eButtonTransSelText","eDivResult","eSelTextTrans","eOrigText","origTextContainer","originalTabLanguage","currentTargetLanguages","get","currentTargetLanguage","currentTextTranslatorService","awaysTranslateThisSite","indexOf","translateThisSite","translateThisLanguage","showTranslateSelectedButton","dontShowIfPageLangIsTargetLang","dontShowIfPageLangIsUnknown","dontShowIfSelectedTextIsTargetLang","dontShowIfSelectedTextIsUnknown","fooCount","pageTranslator","onGetOriginalTabLanguage","tabLanguage","updateEventListener","detectTextLanguage","text","i18n","detectLanguage","lang","isReliable","langInfo","languages","langCode","twpLang","fixTLanguageCode","language","isPlayingAudio","playAudio","targetLanguage","cbOnEnded","stopAudio","dragElement","elmnt","elmnt2","pos1","pos2","pos3","pos4","addEventListener","dragMouseDown","e","window","event","preventDefault","clientX","clientY","document","closeDragElement","elementDrag","style","top","Math","min","innerHeight","parseInt","getComputedStyle","height","max","offsetTop","left","offsetLeft","removeEventListener","setCaretAtEnd","el","range","createRange","sel","getSelection","setStart","textContent","length","collapse","removeAllRanges","addRange","focus","onCSSLoad","isCSSLoaded","init","destroy","isTranslatingSelected","createElement","classList","add","shadowRoot","attachShadow","mode","innerHTML","link","setAttribute","getURL","onload","appendChild","styleFix","getElementById","isFirefox","navigator","userAgent","toLowerCase","CSS","supports","darkMode","matchMedia","matches","eMoreOrLess","eMore","eLess","sGoogle","sYandex","sBing","sDeepL","eCopy","eReplace","eListenOriginal","eListenTranslated","isInputElement","isContentEditable","removeAttribute","replaceText","prevSelInfo","element","nodeType","parentNode","execCommand","setSelectionRange","selStart","selEnd","selection","onclick","clipboard","writeText","oldBackgroundColor","backgroundColor","setTimeout","onkeypress","stopPropagation","onkeydown","lastTimePressedCtrl","onkeyup","key","performance","now","translateNewInputTimerHandler","oninput","clearTimeout","translateNewInput","set","remove","setTargetLanguage","target","getAttribute","setTargetLanguageTextTranslation","querySelectorAll","forEach","li","onListenClick","type","msgListen","getMessage","msgStopListening","lastListenAudioType","body","translateDocument","platformInfo","isMobile","any","width","onTouchstart","onClick","onDown","targetLanguageButtons","i","codeToLanguage","display","onChanged","name","newvalue","prevHeight","destroyIfButtonIsShowing","newValue","update_eDivResult","onloaded","eTop","bottom","eLeft","isRtlLanguage","offsetHeight","offsetWidth","innerWidth","currentFooCount","backgroundTranslateSingleText","translateSelText","usePrevSelectionInfo","isTouchSelection","getSelectionText","activeEl","activeElement","activeElTagName","tagName","test","selectionStart","value","slice","selectionEnd","toString","readSelection","dontReadIfSelectionDontChange","newSelectionInfo","rect","getBoundingClientRect","right","getRangeAt","focusNode","startOffset","endOffset","onUp","changedTouches","selectedText","trim","detectedLanguage","showButtonTimerHandler","onMouseup","button","onTouchend","onSelectionchange","isSelectingText","onKeyUp","windowIsInFocus","onMessage","addListener","request","sender","sendResponse","readOnly"],"sources":["translateSelected.js"],"sourcesContent":["\"use strict\";\r\n\r\n// TODO especificar o parametro HL para aprimorar a detecção de idioma\r\n//TODO desativar o botão caso a pagina esteja traduzida\r\n\r\nvar translateSelected = {};\r\n\r\nfunction getTabHostName() {\r\n  return new Promise((resolve) =>\r\n    chrome.runtime.sendMessage({ action: \"getTabHostName\" }, (result) => {\r\n      checkedLastError();\r\n\r\n      resolve(result);\r\n    })\r\n  );\r\n}\r\n\r\nPromise.all([twpConfig.onReady(), getTabHostName()]).then(function (_) {\r\n  const tabHostName = _[1];\r\n\r\n  let gSelectionInfo;\r\n  let prevSelectionInfo;\r\n\r\n  let divElement;\r\n  let eButtonTransSelText;\r\n  let eDivResult;\r\n  let eSelTextTrans;\r\n  let eOrigText;\r\n  let origTextContainer;\r\n\r\n  let originalTabLanguage = \"und\";\r\n  let currentTargetLanguages = twpConfig.get(\"targetLanguages\");\r\n  let currentTargetLanguage = twpConfig.get(\"targetLanguageTextTranslation\");\r\n  let currentTextTranslatorService = twpConfig.get(\"textTranslatorService\");\r\n  let awaysTranslateThisSite =\r\n    twpConfig.get(\"alwaysTranslateSites\").indexOf(tabHostName) !== -1;\r\n  let translateThisSite =\r\n    twpConfig.get(\"neverTranslateSites\").indexOf(tabHostName) === -1;\r\n  let translateThisLanguage =\r\n    twpConfig.get(\"neverTranslateLangs\").indexOf(originalTabLanguage) === -1;\r\n  let showTranslateSelectedButton = twpConfig.get(\r\n    \"showTranslateSelectedButton\"\r\n  );\r\n  let dontShowIfPageLangIsTargetLang = twpConfig.get(\r\n    \"dontShowIfPageLangIsTargetLang\"\r\n  );\r\n  let dontShowIfPageLangIsUnknown = twpConfig.get(\r\n    \"dontShowIfPageLangIsUnknown\"\r\n  );\r\n  let dontShowIfSelectedTextIsTargetLang = twpConfig.get(\r\n    \"dontShowIfSelectedTextIsTargetLang\"\r\n  );\r\n  let dontShowIfSelectedTextIsUnknown = twpConfig.get(\r\n    \"dontShowIfSelectedTextIsUnknown\"\r\n  );\r\n  let fooCount = 0;\r\n\r\n  pageTranslator.onGetOriginalTabLanguage(function (tabLanguage) {\r\n    originalTabLanguage = tabLanguage;\r\n    translateThisLanguage =\r\n      twpConfig.get(\"neverTranslateLangs\").indexOf(originalTabLanguage) === -1;\r\n    updateEventListener();\r\n  });\r\n\r\n  async function detectTextLanguage(text) {\r\n    if (!chrome.i18n.detectLanguage) return \"und\";\r\n\r\n    return await new Promise((resolve) => {\r\n      chrome.i18n.detectLanguage(text, (result) => {\r\n        if (!result) return resolve({ lang: \"und\", isReliable: false });\r\n\r\n        for (const langInfo of result.languages) {\r\n          const langCode = twpLang.fixTLanguageCode(langInfo.language);\r\n          if (langCode) {\r\n            return resolve({ lang: langCode, isReliable: result.isReliable });\r\n          }\r\n        }\r\n\r\n        return resolve({ lang: \"und\", isReliable: false });\r\n      });\r\n    });\r\n  }\r\n\r\n  let isPlayingAudio = false;\r\n\r\n  function playAudio(text, targetLanguage, cbOnEnded = () => {}) {\r\n    isPlayingAudio = true;\r\n    chrome.runtime.sendMessage(\r\n      {\r\n        action: \"textToSpeech\",\r\n        text,\r\n        targetLanguage,\r\n      },\r\n      () => {\r\n        checkedLastError();\r\n\r\n        isPlayingAudio = false;\r\n        cbOnEnded();\r\n      }\r\n    );\r\n  }\r\n\r\n  function stopAudio() {\r\n    if (!isPlayingAudio) return;\r\n    isPlayingAudio = false;\r\n    chrome.runtime.sendMessage(\r\n      {\r\n        action: \"stopAudio\",\r\n      },\r\n      checkedLastError\r\n    );\r\n  }\r\n\r\n  function dragElement(elmnt, elmnt2) {\r\n    var pos1 = 0,\r\n      pos2 = 0,\r\n      pos3 = 0,\r\n      pos4 = 0;\r\n    if (elmnt2) {\r\n      elmnt2.addEventListener(\"mousedown\", dragMouseDown);\r\n    } else {\r\n      elmnt.addEventListener(\"mousedown\", dragMouseDown);\r\n    }\r\n\r\n    function dragMouseDown(e) {\r\n      e = e || window.event;\r\n      e.preventDefault();\r\n      // get the mouse cursor position at startup:\r\n      pos3 = e.clientX;\r\n      pos4 = e.clientY;\r\n      document.addEventListener(\"mouseup\", closeDragElement);\r\n      // call a function whenever the cursor moves:\r\n      document.addEventListener(\"mousemove\", elementDrag);\r\n    }\r\n\r\n    function elementDrag(e) {\r\n      e = e || window.event;\r\n      e.preventDefault();\r\n      // calculate the new cursor position:\r\n      pos1 = pos3 - e.clientX;\r\n      pos2 = pos4 - e.clientY;\r\n      pos3 = e.clientX;\r\n      pos4 = e.clientY;\r\n      // set the element's new position:\r\n      elmnt.style.top =\r\n        Math.min(\r\n          window.innerHeight - parseInt(getComputedStyle(elmnt).height),\r\n          Math.max(0, elmnt.offsetTop - pos2)\r\n        ) + \"px\";\r\n      elmnt.style.left = Math.max(0, elmnt.offsetLeft - pos1) + \"px\";\r\n    }\r\n\r\n    function closeDragElement() {\r\n      // stop moving when mouse button is released:\r\n      document.removeEventListener(\"mouseup\", closeDragElement);\r\n      document.removeEventListener(\"mousemove\", elementDrag);\r\n    }\r\n  }\r\n\r\n  function setCaretAtEnd() {\r\n    const el = eOrigText;\r\n    const range = document.createRange();\r\n    const sel = window.getSelection();\r\n    range.setStart(el, el.textContent.length > 0 ? 1 : 0);\r\n    range.collapse(true);\r\n    sel.removeAllRanges();\r\n    sel.addRange(range);\r\n    el.focus();\r\n  }\r\n\r\n  let onCSSLoad = null;\r\n  let isCSSLoaded = false;\r\n\r\n  function init() {\r\n    destroy();\r\n\r\n    window.isTranslatingSelected = true;\r\n\r\n    divElement = document.createElement(\"div\");\r\n    divElement.style = \"all: initial\";\r\n    divElement.classList.add(\"notranslate\");\r\n\r\n    const shadowRoot = divElement.attachShadow({\r\n      mode: \"closed\",\r\n    });\r\n\r\n    shadowRoot.innerHTML = `\r\n        <div id=\"eButtonTransSelText\" style=\"display: none\"></div>\r\n\t\t<div id=\"eDivResult\" style=\"display: none\">\r\n\t\t\t<div id=\"origTextContainer\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div id=\"eOrigText\" contentEditable=\"true\" spellcheck=\"false\" dir=\"auto\"></div>\r\n\t\t\t\t\t<hr>\r\n\t\t\t\t</div>\r\n\t\t\t\t<ul><li title=\"Listen\" data-i18n-title=\"btnListen\" id=\"listenOriginal\">\r\n\t\t\t\t\t<svg id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"10px\" height=\"10px\" viewBox=\"0 0 93.038 93.038\"\r\n\t\t\t\t\t\tstyle=\"enable-background:new 0 0 93.038 93.038;\" xml:space=\"preserve\">\r\n\t\t\t\t\t<g>\r\n\t\t\t\t\t\t<path d=\"M46.547,75.521c0,1.639-0.947,3.128-2.429,3.823c-0.573,0.271-1.187,0.402-1.797,0.402c-0.966,0-1.923-0.332-2.696-0.973\r\n\t\t\t\t\t\tl-23.098-19.14H4.225C1.892,59.635,0,57.742,0,55.409V38.576c0-2.334,1.892-4.226,4.225-4.226h12.303l23.098-19.14\r\n\t\t\t\t\t\tc1.262-1.046,3.012-1.269,4.493-0.569c1.481,0.695,2.429,2.185,2.429,3.823L46.547,75.521L46.547,75.521z M62.784,68.919\r\n\t\t\t\t\t\tc-0.103,0.007-0.202,0.011-0.304,0.011c-1.116,0-2.192-0.441-2.987-1.237l-0.565-0.567c-1.482-1.479-1.656-3.822-0.408-5.504\r\n\t\t\t\t\t\tc3.164-4.266,4.834-9.323,4.834-14.628c0-5.706-1.896-11.058-5.484-15.478c-1.366-1.68-1.24-4.12,0.291-5.65l0.564-0.565\r\n\t\t\t\t\t\tc0.844-0.844,1.975-1.304,3.199-1.231c1.192,0.06,2.305,0.621,3.061,1.545c4.977,6.09,7.606,13.484,7.606,21.38\r\n\t\t\t\t\t\tc0,7.354-2.325,14.354-6.725,20.24C65.131,68.216,64.007,68.832,62.784,68.919z M80.252,81.976\r\n\t\t\t\t\t\tc-0.764,0.903-1.869,1.445-3.052,1.495c-0.058,0.002-0.117,0.004-0.177,0.004c-1.119,0-2.193-0.442-2.988-1.237l-0.555-0.555\r\n\t\t\t\t\t\tc-1.551-1.55-1.656-4.029-0.246-5.707c6.814-8.104,10.568-18.396,10.568-28.982c0-11.011-4.019-21.611-11.314-29.847\r\n\t\t\t\t\t\tc-1.479-1.672-1.404-4.203,0.17-5.783l0.554-0.555c0.822-0.826,1.89-1.281,3.115-1.242c1.163,0.033,2.263,0.547,3.036,1.417\r\n\t\t\t\t\t\tc8.818,9.928,13.675,22.718,13.675,36.01C93.04,59.783,88.499,72.207,80.252,81.976z\"/>\r\n\t\t\t\t\t</g>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</li></ul>\r\n\t\t\t</div>\r\n\t\t\t<div id=\"transTextContainer\">\r\n\t\t\t\t<div id=\"eSelTextTrans\" dir=\"auto\"></div>\r\n\t\t\t\t<ul>\r\n\t\t\t\t\t<li title=\"Listen\" data-i18n-title=\"btnListen\" id=\"listenTranslated\">\r\n\t\t\t\t\t\t<svg id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"10px\" height=\"10px\" viewBox=\"0 0 93.038 93.038\"\r\n\t\t\t\t\t\t\tstyle=\"enable-background:new 0 0 93.038 93.038;\" xml:space=\"preserve\">\r\n\t\t\t\t\t\t<g>\r\n\t\t\t\t\t\t\t<path d=\"M46.547,75.521c0,1.639-0.947,3.128-2.429,3.823c-0.573,0.271-1.187,0.402-1.797,0.402c-0.966,0-1.923-0.332-2.696-0.973\r\n\t\t\t\t\t\t\tl-23.098-19.14H4.225C1.892,59.635,0,57.742,0,55.409V38.576c0-2.334,1.892-4.226,4.225-4.226h12.303l23.098-19.14\r\n\t\t\t\t\t\t\tc1.262-1.046,3.012-1.269,4.493-0.569c1.481,0.695,2.429,2.185,2.429,3.823L46.547,75.521L46.547,75.521z M62.784,68.919\r\n\t\t\t\t\t\t\tc-0.103,0.007-0.202,0.011-0.304,0.011c-1.116,0-2.192-0.441-2.987-1.237l-0.565-0.567c-1.482-1.479-1.656-3.822-0.408-5.504\r\n\t\t\t\t\t\t\tc3.164-4.266,4.834-9.323,4.834-14.628c0-5.706-1.896-11.058-5.484-15.478c-1.366-1.68-1.24-4.12,0.291-5.65l0.564-0.565\r\n\t\t\t\t\t\t\tc0.844-0.844,1.975-1.304,3.199-1.231c1.192,0.06,2.305,0.621,3.061,1.545c4.977,6.09,7.606,13.484,7.606,21.38\r\n\t\t\t\t\t\t\tc0,7.354-2.325,14.354-6.725,20.24C65.131,68.216,64.007,68.832,62.784,68.919z M80.252,81.976\r\n\t\t\t\t\t\t\tc-0.764,0.903-1.869,1.445-3.052,1.495c-0.058,0.002-0.117,0.004-0.177,0.004c-1.119,0-2.193-0.442-2.988-1.237l-0.555-0.555\r\n\t\t\t\t\t\t\tc-1.551-1.55-1.656-4.029-0.246-5.707c6.814-8.104,10.568-18.396,10.568-28.982c0-11.011-4.019-21.611-11.314-29.847\r\n\t\t\t\t\t\t\tc-1.479-1.672-1.404-4.203,0.17-5.783l0.554-0.555c0.822-0.826,1.89-1.281,3.115-1.242c1.163,0.033,2.263,0.547,3.036,1.417\r\n\t\t\t\t\t\t\tc8.818,9.928,13.675,22.718,13.675,36.01C93.04,59.783,88.499,72.207,80.252,81.976z\"/>\r\n\t\t\t\t\t\t</g>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li title=\"Copy\" data-i18n-title=\"btnCopy\" id=\"copy\">\r\n\t\t\t\t\t\t<svg width=\"10\" height=\"10\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n\t\t\t\t\t\t<path d=\"M13 7H7V5H13V7Z\" fill=\"currentColor\" />\r\n\t\t\t\t\t\t<path d=\"M13 11H7V9H13V11Z\" fill=\"currentColor\" />\r\n\t\t\t\t\t\t<path d=\"M7 15H13V13H7V15Z\" fill=\"currentColor\" />\r\n\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M3 19V1H17V5H21V23H7V19H3ZM15 17V3H5V17H15ZM17 7V19H9V21H19V7H17Z\" fill=\"currentColor\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li title=\"Replace\" data-i18n-title=\"btnReplace\" id=\"replace\" hidden>\r\n\t\t\t\t\t\t<svg width=\"10\" height=\"10\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n\t\t\t\t\t\t<path\r\n\t\t\t\t\t\td=\"M5.75739 7.17154L7.1716 5.75732L16.2426 14.8283L16.2426 10.2427H18.2426L18.2426 18.2427H10.2426V16.2427L14.8285 16.2427L5.75739 7.17154Z\"\r\n\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t\t<div id=\"drag\">\r\n\t\t\t\t<ul id=\"setTargetLanguage\">\r\n\t\t\t\t\t<li value=\"en\" title=\"English\">en</li>\r\n\t\t\t\t\t<li value=\"es\" title=\"Spanish\">es</li>\r\n\t\t\t\t\t<li value=\"de\" title=\"German\">de</li>\r\n\t\t\t\t</ul>\r\n\t\t\t\t<div id=\"moreOrLess\"><i class=\"arrow up\" id=\"more\"></i><i class=\"arrow down\" id=\"less\"></i></div>\r\n\t\t\t\t<ul>\r\n\t\t\t\t\t<li title=\"Google\" id=\"sGoogle\">g</li>\r\n\t\t\t\t\t<li title=\"Yandex\" id=\"sYandex\">y</li>\r\n\t\t\t\t\t<li title=\"Bing\" id=\"sBing\">b</li>\r\n\t\t\t\t\t<li title=\"DeepL\" id=\"sDeepL\" hidden>d</li>\r\n\t\t\t\t\t<li style=\"opacity: 0; cursor: move;\">O</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</div>\r\n        `;\r\n\r\n    const link = document.createElement(\"link\");\r\n    link.setAttribute(\"rel\", \"stylesheet\");\r\n    link.setAttribute(\r\n      \"href\",\r\n      chrome.runtime.getURL(\"/contentScript/css/translateSelected.css\")\r\n    );\r\n    isCSSLoaded = false;\r\n    link.onload = (e) => {\r\n      isCSSLoaded = true;\r\n      if (onCSSLoad) onCSSLoad();\r\n    };\r\n    shadowRoot.appendChild(link);\r\n\r\n    const styleFix = document.createElement(\"style\");\r\n    styleFix.textContent = `\r\n\t\t#eSelTextTrans,#eOrigText {\r\n\t\t\tmargin-right: 22px;\r\n\t\t}\r\n\t\t#eDivResult {\r\n\t\t\tmin-width: 300px;\r\n\t\t}\r\n\t\t`;\r\n    shadowRoot.appendChild(styleFix);\r\n\r\n    dragElement(\r\n      shadowRoot.getElementById(\"eDivResult\"),\r\n      shadowRoot.getElementById(\"drag\")\r\n    );\r\n\r\n    const isFirefox = navigator.userAgent.toLowerCase().indexOf(\"firefox\") > -1;\r\n\r\n    if (CSS.supports(\"backdrop-filter: blur(5px)\") && !isFirefox && false) {\r\n      const el = document.createElement(\"style\");\r\n      el.setAttribute(\"id\", \"backdropFilterElement\");\r\n      el.setAttribute(\"rel\", \"stylesheet\");\r\n      el.textContent = `\r\n                    #eDivResult {\r\n                        backdrop-filter: blur(3px);\r\n                        background-color: rgba(0, 0, 0, 0.5);\r\n                    }\r\n                    li {\r\n                    \tbackground-color: rgba(255, 255, 255, 0.1);\r\n                    }\r\n                    .selected {\r\n                    \tbackground-color: rgba(255, 255, 255, 0.3);\r\n                    }\r\n                    #moreOrLess {\r\n                \t\tbackground-color: rgba(255, 255, 255, 0.1);\r\n            \t\t}\r\n            \t\thr {\r\n            \t\t\tborder: 1px rgba(255, 255, 255, 0.5) solid;\r\n            \t\t}\r\n            \t\t#listen {\r\n            \t\t    fill: white;\r\n            \t\t}\r\n                `;\r\n      shadowRoot.appendChild(el);\r\n    } else {\r\n      const el = document.createElement(\"style\");\r\n      el.setAttribute(\"id\", \"backdropFilterElement\");\r\n      el.setAttribute(\"rel\", \"stylesheet\");\r\n      let darkMode = false;\r\n      switch (twpConfig.get(\"darkMode\")) {\r\n        case \"auto\":\r\n          if (matchMedia(\"(prefers-color-scheme: dark)\").matches)\r\n            darkMode = true;\r\n          break;\r\n        case \"yes\":\r\n          darkMode = true;\r\n          break;\r\n      }\r\n      if (darkMode === true) {\r\n        el.textContent = `\r\n                    #eDivResult {\r\n                        backdrop-filter: none;\r\n                        background-color: rgba(25, 25, 25, 0.98);\r\n                        color: white;\r\n                    }\r\n                    li, #moreOrLess {\r\n                    \tbackground-color: rgba(255, 255, 255, 0.2);\r\n                    }\r\n                    .selected {\r\n                    \tbackground-color: rgba(255, 255, 255, 0.4);\r\n                    }\r\n            \t\thr {\r\n            \t\t\tborder: 1px rgba(225, 225, 225, 0.75) solid;\r\n            \t\t}\r\n            \t\t#listen {\r\n            \t\t    fill: white;\r\n            \t\t}\r\n                `;\r\n      } else {\r\n        el.textContent = `\r\n                    #eDivResult {\r\n                        backdrop-filter: none;\r\n                        background-color: rgba(225, 225, 225, 0.98);\r\n                        color: black;\r\n                    }\r\n                    li, #moreOrLess {\r\n                    \tbackground-color: rgba(0, 0, 0, 0.2);\r\n                    }\r\n                    .selected {\r\n                    \tbackground-color: rgba(0, 0, 0, 0.4);\r\n                    }\r\n            \t\thr {\r\n            \t\t\tborder: 1px rgba(0, 0, 0, 0.75) solid;\r\n            \t\t}\r\n            \t\t#listen {\r\n            \t\t    fill: black;\r\n            \t\t}\r\n                `;\r\n      }\r\n      shadowRoot.appendChild(el);\r\n    }\r\n\r\n    eButtonTransSelText = shadowRoot.getElementById(\"eButtonTransSelText\");\r\n    eDivResult = shadowRoot.getElementById(\"eDivResult\");\r\n    eSelTextTrans = shadowRoot.getElementById(\"eSelTextTrans\");\r\n    eOrigText = shadowRoot.getElementById(\"eOrigText\");\r\n    origTextContainer = shadowRoot.getElementById(\"origTextContainer\");\r\n\r\n    const eMoreOrLess = shadowRoot.getElementById(\"moreOrLess\");\r\n    const eMore = shadowRoot.getElementById(\"more\");\r\n    const eLess = shadowRoot.getElementById(\"less\");\r\n\r\n    const sGoogle = shadowRoot.getElementById(\"sGoogle\");\r\n    const sYandex = shadowRoot.getElementById(\"sYandex\");\r\n    const sBing = shadowRoot.getElementById(\"sBing\");\r\n    const sDeepL = shadowRoot.getElementById(\"sDeepL\");\r\n    const eCopy = shadowRoot.getElementById(\"copy\");\r\n    const eReplace = shadowRoot.getElementById(\"replace\");\r\n    const eListenOriginal = shadowRoot.getElementById(\"listenOriginal\");\r\n    const eListenTranslated = shadowRoot.getElementById(\"listenTranslated\");\r\n\r\n    if (\r\n      gSelectionInfo &&\r\n      (gSelectionInfo.isInputElement || gSelectionInfo.isContentEditable)\r\n    ) {\r\n      eCopy.setAttribute(\"hidden\", \"\");\r\n      eReplace.removeAttribute(\"hidden\");\r\n    } else {\r\n      eCopy.removeAttribute(\"hidden\");\r\n      eReplace.setAttribute(\"hidden\", \"\");\r\n    }\r\n\r\n    function replaceText() {\r\n      const prevSelInfo = prevSelectionInfo;\r\n      destroy();\r\n      if (prevSelInfo.element.nodeType === 3) {\r\n        prevSelInfo.element.parentNode.focus();\r\n      } else {\r\n        prevSelInfo.element.focus();\r\n      }\r\n      document.execCommand(\"selectAll\", false);\r\n      if (prevSelInfo.isInputElement) {\r\n        prevSelInfo.element.setSelectionRange(\r\n          prevSelInfo.selStart,\r\n          prevSelInfo.selEnd\r\n        );\r\n      } else if (prevSelInfo.isContentEditable) {\r\n        const selection = window.getSelection();\r\n        selection.removeAllRanges();\r\n        selection.addRange(prevSelInfo.range);\r\n      }\r\n      document.execCommand(\"insertText\", false, eSelTextTrans.textContent);\r\n    }\r\n\r\n    eCopy.onclick = () => {\r\n      navigator.clipboard.writeText(eSelTextTrans.textContent).then(() => {\r\n        const oldBackgroundColor = eCopy.style.backgroundColor;\r\n        eCopy.style.backgroundColor = \"rgba(0, 255, 0, 0.4)\";\r\n        setTimeout(() => {\r\n          eCopy.style.backgroundColor = oldBackgroundColor;\r\n        }, 500);\r\n      });\r\n    };\r\n\r\n    eReplace.onclick = replaceText;\r\n\r\n    eOrigText.onkeypress = (e) => {\r\n      e.stopPropagation();\r\n    };\r\n\r\n    eOrigText.onkeydown = (e) => {\r\n      e.stopPropagation();\r\n    };\r\n\r\n    let lastTimePressedCtrl = null;\r\n\r\n    eOrigText.onkeyup = (e) => {\r\n      if (twpConfig.get(\"translateSelectedWhenPressTwice\") !== \"yes\") return;\r\n      if (e.key == \"Control\") {\r\n        if (\r\n          lastTimePressedCtrl &&\r\n          performance.now() - lastTimePressedCtrl < 250\r\n        ) {\r\n          lastTimePressedCtrl = performance.now();\r\n          replaceText();\r\n        }\r\n        lastTimePressedCtrl = performance.now();\r\n      }\r\n    };\r\n\r\n    let translateNewInputTimerHandler;\r\n    eOrigText.oninput = () => {\r\n      clearTimeout(translateNewInputTimerHandler);\r\n      translateNewInputTimerHandler = setTimeout(translateNewInput, 800);\r\n    };\r\n\r\n    eMoreOrLess.onclick = () => {\r\n      if (twpConfig.get(\"expandPanelTranslateSelectedText\") === \"no\") {\r\n        twpConfig.set(\"expandPanelTranslateSelectedText\", \"yes\");\r\n      } else {\r\n        twpConfig.set(\"expandPanelTranslateSelectedText\", \"no\");\r\n      }\r\n\r\n      setCaretAtEnd();\r\n    };\r\n\r\n    sGoogle.onclick = () => {\r\n      currentTextTranslatorService = \"google\";\r\n      twpConfig.set(\"textTranslatorService\", \"google\");\r\n      translateNewInput();\r\n\r\n      sGoogle.classList.remove(\"selected\");\r\n      sYandex.classList.remove(\"selected\");\r\n      sBing.classList.remove(\"selected\");\r\n      sDeepL.classList.remove(\"selected\");\r\n\r\n      sGoogle.classList.add(\"selected\");\r\n    };\r\n    sYandex.onclick = () => {\r\n      currentTextTranslatorService = \"yandex\";\r\n      twpConfig.set(\"textTranslatorService\", \"yandex\");\r\n      translateNewInput();\r\n\r\n      sGoogle.classList.remove(\"selected\");\r\n      sYandex.classList.remove(\"selected\");\r\n      sBing.classList.remove(\"selected\");\r\n      sDeepL.classList.remove(\"selected\");\r\n\r\n      sYandex.classList.add(\"selected\");\r\n    };\r\n    sBing.onclick = () => {\r\n      currentTextTranslatorService = \"bing\";\r\n      twpConfig.set(\"textTranslatorService\", \"bing\");\r\n      translateNewInput();\r\n\r\n      sGoogle.classList.remove(\"selected\");\r\n      sYandex.classList.remove(\"selected\");\r\n      sBing.classList.remove(\"selected\");\r\n      sDeepL.classList.remove(\"selected\");\r\n\r\n      sBing.classList.add(\"selected\");\r\n    };\r\n    sDeepL.onclick = () => {\r\n      currentTextTranslatorService = \"deepl\";\r\n      twpConfig.set(\"textTranslatorService\", \"deepl\");\r\n      translateNewInput();\r\n\r\n      sGoogle.classList.remove(\"selected\");\r\n      sYandex.classList.remove(\"selected\");\r\n      sBing.classList.remove(\"selected\");\r\n      sDeepL.classList.remove(\"selected\");\r\n\r\n      sDeepL.classList.add(\"selected\");\r\n    };\r\n\r\n    const setTargetLanguage = shadowRoot.getElementById(\"setTargetLanguage\");\r\n    setTargetLanguage.onclick = (e) => {\r\n      if (e.target.getAttribute(\"value\")) {\r\n        const langCode = twpLang.fixTLanguageCode(\r\n          e.target.getAttribute(\"value\")\r\n        );\r\n        if (langCode) {\r\n          currentTargetLanguage = langCode;\r\n          twpConfig.setTargetLanguageTextTranslation(langCode);\r\n          translateNewInput();\r\n        }\r\n\r\n        shadowRoot.querySelectorAll(\"#setTargetLanguage li\").forEach((li) => {\r\n          li.classList.remove(\"selected\");\r\n        });\r\n\r\n        e.target.classList.add(\"selected\");\r\n      }\r\n    };\r\n\r\n    function onListenClick(type, element, text, language) {\r\n      const msgListen = chrome.i18n.getMessage(\"btnListen\");\r\n      const msgStopListening = chrome.i18n.getMessage(\"btnStopListening\");\r\n\r\n      eListenOriginal.classList.remove(\"selected\");\r\n      eListenTranslated.classList.remove(\"selected\");\r\n      eListenOriginal.setAttribute(\"title\", msgStopListening);\r\n      eListenTranslated.setAttribute(\"title\", msgStopListening);\r\n\r\n      if (isPlayingAudio) {\r\n        stopAudio();\r\n        element.classList.remove(\"selected\");\r\n      } else {\r\n        playAudio(text, language, () => {\r\n          element.classList.remove(\"selected\");\r\n          element.setAttribute(\"title\", msgListen);\r\n        });\r\n        element.classList.add(\"selected\");\r\n      }\r\n    }\r\n\r\n    let lastListenAudioType = null;\r\n    eListenOriginal.onclick = async () => {\r\n      let { lang, isReliable } = await detectTextLanguage(\r\n        eOrigText.textContent\r\n      );\r\n      if (!isReliable && originalTabLanguage !== \"und\") {\r\n        lang = originalTabLanguage;\r\n      }\r\n      if (lastListenAudioType !== \"original\") {\r\n        stopAudio();\r\n      }\r\n      lastListenAudioType = \"original\";\r\n      onListenClick(\"original\", eListenOriginal, eOrigText.textContent, lang);\r\n    };\r\n\r\n    eListenTranslated.onclick = () => {\r\n      if (lastListenAudioType !== \"translated\") {\r\n        stopAudio();\r\n      }\r\n      lastListenAudioType = \"translated\";\r\n      onListenClick(\r\n        \"translated\",\r\n        eListenTranslated,\r\n        eSelTextTrans.textContent,\r\n        currentTargetLanguage\r\n      );\r\n    };\r\n\r\n    document.body.appendChild(divElement);\r\n\r\n    chrome.i18n.translateDocument(shadowRoot);\r\n\r\n    if (platformInfo.isMobile.any) {\r\n      eButtonTransSelText.style.width = \"30px\";\r\n      eButtonTransSelText.style.height = \"30px\";\r\n      document.addEventListener(\"touchstart\", onTouchstart);\r\n    }\r\n\r\n    eButtonTransSelText.addEventListener(\"click\", onClick);\r\n    document.addEventListener(\"mousedown\", onDown);\r\n\r\n    const targetLanguageButtons = shadowRoot.querySelectorAll(\r\n      \"#setTargetLanguage li\"\r\n    );\r\n\r\n    for (let i = 0; i < 3; i++) {\r\n      if (currentTargetLanguages[i] == currentTargetLanguage) {\r\n        targetLanguageButtons[i].classList.add(\"selected\");\r\n      }\r\n      targetLanguageButtons[i].textContent = currentTargetLanguages[i];\r\n      targetLanguageButtons[i].setAttribute(\"value\", currentTargetLanguages[i]);\r\n      targetLanguageButtons[i].setAttribute(\r\n        \"title\",\r\n        twpLang.codeToLanguage(currentTargetLanguages[i])\r\n      );\r\n    }\r\n\r\n    if (currentTextTranslatorService === \"yandex\") {\r\n      sYandex.classList.add(\"selected\");\r\n    } else if (currentTextTranslatorService == \"deepl\") {\r\n      sDeepL.classList.add(\"selected\");\r\n    } else if (currentTextTranslatorService == \"bing\") {\r\n      sBing.classList.add(\"selected\");\r\n    } else {\r\n      sGoogle.classList.add(\"selected\");\r\n    }\r\n\r\n    if (twpConfig.get(\"enableDeepL\") === \"yes\") {\r\n      sDeepL.removeAttribute(\"hidden\");\r\n    } else {\r\n      sDeepL.setAttribute(\"hidden\", \"\");\r\n    }\r\n\r\n    if (\r\n      twpConfig.get(\"expandPanelTranslateSelectedText\") === \"yes\" ||\r\n      (prevSelectionInfo &&\r\n        (prevSelectionInfo.isContentEditable ||\r\n          prevSelectionInfo.isInputElement))\r\n    ) {\r\n      origTextContainer.style.display = \"block\";\r\n      eMore.style.display = \"none\";\r\n      eLess.style.display = \"block\";\r\n      eMoreOrLess.setAttribute(\"title\", chrome.i18n.getMessage(\"less\"));\r\n    } else {\r\n      origTextContainer.style.display = \"none\";\r\n      eMore.style.display = \"block\";\r\n      eLess.style.display = \"none\";\r\n      eMoreOrLess.setAttribute(\"title\", chrome.i18n.getMessage(\"more\"));\r\n    }\r\n\r\n    twpConfig.onChanged((name, newvalue) => {\r\n      switch (name) {\r\n        case \"enableDeepL\":\r\n          if (newvalue === \"yes\") {\r\n            sDeepL.removeAttribute(\"hidden\");\r\n          } else {\r\n            sDeepL.setAttribute(\"hidden\", \"\");\r\n          }\r\n          break;\r\n        case \"expandPanelTranslateSelectedText\":\r\n          const prevHeight = parseInt(getComputedStyle(eDivResult).height);\r\n          if (newvalue === \"yes\") {\r\n            origTextContainer.style.display = \"block\";\r\n            eMore.style.display = \"none\";\r\n            eLess.style.display = \"block\";\r\n            eMoreOrLess.setAttribute(\"title\", chrome.i18n.getMessage(\"less\"));\r\n            eDivResult.style.top =\r\n              parseInt(eDivResult.style.top) +\r\n              (prevHeight - parseInt(getComputedStyle(eDivResult).height)) +\r\n              \"px\";\r\n          } else {\r\n            origTextContainer.style.display = \"none\";\r\n            eMore.style.display = \"block\";\r\n            eLess.style.display = \"none\";\r\n            eMoreOrLess.setAttribute(\"title\", chrome.i18n.getMessage(\"more\"));\r\n            eDivResult.style.top =\r\n              parseInt(eDivResult.style.top) +\r\n              (prevHeight - parseInt(getComputedStyle(eDivResult).height)) +\r\n              \"px\";\r\n          }\r\n          break;\r\n      }\r\n    });\r\n  }\r\n\r\n  function destroy() {\r\n    window.isTranslatingSelected = false;\r\n    fooCount++;\r\n    stopAudio();\r\n    if (!divElement) return;\r\n\r\n    eButtonTransSelText.removeEventListener(\"click\", onClick);\r\n    document.removeEventListener(\"mousedown\", onDown);\r\n    if (platformInfo.isMobile.any) {\r\n      document.removeEventListener(\"touchstart\", onTouchstart);\r\n    }\r\n    divElement.remove();\r\n    divElement = eButtonTransSelText = eDivResult = null;\r\n  }\r\n\r\n  function destroyIfButtonIsShowing(e) {\r\n    if (\r\n      eButtonTransSelText &&\r\n      e.target !== divElement &&\r\n      eButtonTransSelText.style.display === \"block\"\r\n    ) {\r\n      destroy();\r\n    }\r\n  }\r\n\r\n  twpConfig.onChanged(function (name, newValue) {\r\n    switch (name) {\r\n      case \"textTranslatorService\":\r\n        currentTextTranslatorService = newValue;\r\n        break;\r\n      case \"targetLanguages\":\r\n        currentTargetLanguages = newValue;\r\n        break;\r\n      case \"targetLanguageTextTranslation\":\r\n        currentTargetLanguage = newValue;\r\n        break;\r\n      case \"alwaysTranslateSites\":\r\n        awaysTranslateThisSite = newValue.indexOf(tabHostName) !== -1;\r\n        updateEventListener();\r\n        break;\r\n      case \"neverTranslateSites\":\r\n        translateThisSite = newValue.indexOf(tabHostName) === -1;\r\n        updateEventListener();\r\n        break;\r\n      case \"neverTranslateLangs\":\r\n        translateThisLanguage = newValue.indexOf(originalTabLanguage) === -1;\r\n        updateEventListener();\r\n        break;\r\n      case \"showTranslateSelectedButton\":\r\n        showTranslateSelectedButton = newValue;\r\n        updateEventListener();\r\n        break;\r\n      case \"dontShowIfPageLangIsTargetLang\":\r\n        dontShowIfPageLangIsTargetLang = newValue;\r\n        updateEventListener();\r\n        break;\r\n      case \"dontShowIfPageLangIsUnknown\":\r\n        dontShowIfPageLangIsUnknown = newValue;\r\n        updateEventListener();\r\n        break;\r\n      case \"dontShowIfSelectedTextIsTargetLang\":\r\n        dontShowIfSelectedTextIsTargetLang = newValue;\r\n        break;\r\n      case \"dontShowIfSelectedTextIsUnknown\":\r\n        dontShowIfSelectedTextIsUnknown = newValue;\r\n        break;\r\n    }\r\n  });\r\n\r\n  function update_eDivResult(result = \"\") {\r\n    if (eDivResult.style.display !== \"block\") {\r\n      init();\r\n    }\r\n\r\n    function onloaded() {\r\n      const eTop = prevSelectionInfo.bottom;\r\n      const eLeft = prevSelectionInfo.left;\r\n\r\n      if (twpLang.isRtlLanguage(currentTargetLanguage)) {\r\n        eSelTextTrans.setAttribute(\"dir\", \"rtl\");\r\n      } else {\r\n        eSelTextTrans.setAttribute(\"dir\", \"ltr\");\r\n      }\r\n      eSelTextTrans.textContent = result;\r\n      let top = parseInt(eDivResult.style.top) || 0,\r\n        left = parseInt(eDivResult.style.left) || 0;\r\n      if (eDivResult.style.display !== \"block\") {\r\n        eDivResult.style.display = \"block\";\r\n        eDivResult.style.top = \"0px\";\r\n        eDivResult.style.left = \"0px\";\r\n        eOrigText.textContent = prevSelectionInfo.text;\r\n\r\n        setCaretAtEnd();\r\n\r\n        const height = parseInt(eDivResult.offsetHeight);\r\n        top = eTop + 5;\r\n        top = Math.max(0, top);\r\n        top = Math.min(window.innerHeight - height, top);\r\n\r\n        const width = parseInt(eDivResult.offsetWidth);\r\n        left = parseInt(eLeft /*- width / 2*/);\r\n        left = Math.max(0, left);\r\n        left = Math.min(window.innerWidth - width, left);\r\n      }\r\n\r\n      eDivResult.style.top =\r\n        Math.min(\r\n          window.innerHeight - parseInt(getComputedStyle(eDivResult).height),\r\n          top\r\n        ) + \"px\";\r\n      eDivResult.style.left =\r\n        Math.min(\r\n          window.innerWidth - parseInt(getComputedStyle(eDivResult).width) - 18,\r\n          left\r\n        ) + \"px\";\r\n    }\r\n\r\n    if (isCSSLoaded) {\r\n      onloaded();\r\n    } else {\r\n      const currentFooCount = fooCount;\r\n      onCSSLoad = () => {\r\n        onCSSLoad = null;\r\n        if (currentFooCount !== fooCount) return;\r\n        onloaded();\r\n      };\r\n    }\r\n  }\r\n\r\n  function translateNewInput() {\r\n    fooCount++;\r\n    const currentFooCount = fooCount;\r\n    stopAudio();\r\n\r\n    backgroundTranslateSingleText(\r\n      currentTextTranslatorService,\r\n      currentTargetLanguage,\r\n      eOrigText.textContent\r\n    ).then((result) => {\r\n      if (currentFooCount !== fooCount) return;\r\n\r\n      update_eDivResult(result);\r\n    });\r\n  }\r\n\r\n  function translateSelText(usePrevSelectionInfo = false) {\r\n    if (!usePrevSelectionInfo && gSelectionInfo) {\r\n      prevSelectionInfo = gSelectionInfo;\r\n    } else if (!(usePrevSelectionInfo && prevSelectionInfo)) {\r\n      return;\r\n    }\r\n\r\n    eOrigText.textContent = prevSelectionInfo.text;\r\n\r\n    translateNewInput();\r\n    const currentFooCount = fooCount;\r\n    setTimeout(() => {\r\n      if (currentFooCount !== fooCount) return;\r\n      update_eDivResult(eSelTextTrans.textContent);\r\n      fooCount = currentFooCount;\r\n    }, 1000);\r\n  }\r\n\r\n  function onClick(e) {\r\n    translateSelText();\r\n    eButtonTransSelText.style.display = \"none\";\r\n  }\r\n\r\n  function onDown(e) {\r\n    if (e.target != divElement) {\r\n      eDivResult.style.display = \"none\";\r\n      eButtonTransSelText.style.display = \"none\";\r\n      destroy();\r\n    }\r\n  }\r\n\r\n  let isTouchSelection = false;\r\n\r\n  function onTouchstart(e) {\r\n    isTouchSelection = true;\r\n    onDown(e);\r\n  }\r\n\r\n  function getSelectionText() {\r\n    let text = \"\";\r\n    const activeEl = document.activeElement;\r\n    const activeElTagName = activeEl ? activeEl.tagName.toLowerCase() : null;\r\n    if (\r\n      activeElTagName == \"textarea\" ||\r\n      (activeElTagName == \"input\" &&\r\n        /^(?:text|search)$/i.test(activeEl.type) &&\r\n        typeof activeEl.selectionStart == \"number\")\r\n    ) {\r\n      text = activeEl.value.slice(\r\n        activeEl.selectionStart,\r\n        activeEl.selectionEnd\r\n      );\r\n    } else if (window.getSelection) {\r\n      text = window.getSelection().toString();\r\n    }\r\n    return text;\r\n  }\r\n\r\n  function readSelection(dontReadIfSelectionDontChange = false) {\r\n    let newSelectionInfo = null;\r\n\r\n    const activeEl = document.activeElement;\r\n    const activeElTagName = activeEl ? activeEl.tagName.toLowerCase() : null;\r\n    if (\r\n      activeElTagName == \"textarea\" ||\r\n      (activeElTagName == \"input\" &&\r\n        /^(?:text|search)$/i.test(activeEl.type) &&\r\n        typeof activeEl.selectionStart == \"number\")\r\n    ) {\r\n      const text = activeEl.value.slice(\r\n        activeEl.selectionStart,\r\n        activeEl.selectionEnd\r\n      );\r\n      const rect = activeEl.getBoundingClientRect();\r\n      newSelectionInfo = {\r\n        isInputElement: true,\r\n        isContentEditable: false,\r\n        element: activeEl,\r\n        selStart: activeEl.selectionStart,\r\n        selEnd: activeEl.selectionEnd,\r\n        text: text,\r\n        top: rect.top,\r\n        left: rect.left,\r\n        bottom: rect.bottom,\r\n        right: rect.right,\r\n      };\r\n    } else if (window.getSelection) {\r\n      const selection = window.getSelection();\r\n      if (selection.type == \"Range\") {\r\n        const text = selection.toString();\r\n        const rect = selection.getRangeAt(0).getBoundingClientRect();\r\n        newSelectionInfo = {\r\n          isInputElement: false,\r\n          isContentEditable:\r\n            selection.focusNode.nodeType === 3\r\n              ? selection.focusNode.parentNode.isContentEditable\r\n              : selection.focusNode.isContentEditable,\r\n          element: selection.focusNode,\r\n          selStart: selection.getRangeAt(0).startOffset,\r\n          selEnd: selection.getRangeAt(0).endOffset,\r\n          text: text,\r\n          top: rect.top,\r\n          left: rect.left,\r\n          bottom: rect.bottom,\r\n          right: rect.right,\r\n          range: selection.getRangeAt(0),\r\n        };\r\n      }\r\n    }\r\n\r\n    if (\r\n      dontReadIfSelectionDontChange &&\r\n      gSelectionInfo &&\r\n      newSelectionInfo &&\r\n      gSelectionInfo.text === newSelectionInfo.text\r\n    ) {\r\n      gSelectionInfo = newSelectionInfo;\r\n      return false;\r\n    }\r\n    gSelectionInfo = newSelectionInfo;\r\n    return true;\r\n  }\r\n\r\n  async function onUp(e) {\r\n    if (e.target == divElement) return;\r\n\r\n    const clientX = Math.max(\r\n      typeof e.clientX === \"undefined\" ? 0 : e.clientX,\r\n      typeof e.changedTouches === \"undefined\" ? 0 : e.changedTouches[0].clientX\r\n    );\r\n    const clientY = Math.max(\r\n      typeof e.clientY === \"undefined\" ? 0 : e.clientY,\r\n      typeof e.changedTouches === \"undefined\" ? 0 : e.changedTouches[0].clientY\r\n    );\r\n\r\n    const selectedText = getSelectionText().trim();\r\n    if (!selectedText || selectedText.length < 1) return;\r\n    let detectedLanguage = (await detectTextLanguage(selectedText)).lang;\r\n    if (!detectedLanguage) detectedLanguage = \"und\";\r\n\r\n    if (\r\n      ((dontShowIfSelectedTextIsTargetLang == \"yes\" &&\r\n        detectedLanguage !== currentTargetLanguage) ||\r\n        dontShowIfSelectedTextIsTargetLang != \"yes\") &&\r\n      ((dontShowIfSelectedTextIsUnknown == \"yes\" &&\r\n        detectedLanguage !== \"und\") ||\r\n        dontShowIfSelectedTextIsUnknown != \"yes\")\r\n    ) {\r\n      init();\r\n      if (platformInfo.isMobile.any) {\r\n        eButtonTransSelText.style.left = window.innerWidth - 45 + \"px\";\r\n        eButtonTransSelText.style.top = clientY + \"px\";\r\n      } else {\r\n        eButtonTransSelText.style.left =\r\n          Math.min(window.innerWidth - 40, clientX + 25) + \"px\";\r\n        eButtonTransSelText.style.top = Math.max(2, clientY - 35) + \"px\";\r\n      }\r\n\r\n      eButtonTransSelText.style.display = \"block\";\r\n    }\r\n  }\r\n\r\n  let showButtonTimerHandler = null;\r\n\r\n  function onMouseup(e) {\r\n    if (e.button != 0) return;\r\n    if (e.target == divElement) return;\r\n    if (readSelection(true)) {\r\n      clearTimeout(showButtonTimerHandler);\r\n      showButtonTimerHandler = setTimeout(() => onUp(e), 150);\r\n    }\r\n  }\r\n\r\n  function onTouchend(e) {\r\n    if (e.target == divElement) return;\r\n    readSelection();\r\n    clearTimeout(showButtonTimerHandler);\r\n    showButtonTimerHandler = setTimeout(() => onUp(e), 150);\r\n  }\r\n\r\n  function onSelectionchange(e) {\r\n    if (isTouchSelection) {\r\n      readSelection();\r\n    }\r\n  }\r\n\r\n  function isSelectingText() {\r\n    const activeEl = document.activeElement;\r\n    const activeElTagName = activeEl ? activeEl.tagName.toLowerCase() : null;\r\n    if (\r\n      activeElTagName == \"textarea\" ||\r\n      (activeElTagName == \"input\" &&\r\n        /^(?:text|search)$/i.test(activeEl.type) &&\r\n        typeof activeEl.selectionStart == \"number\")\r\n    ) {\r\n      const text = activeEl.value.slice(\r\n        activeEl.selectionStart,\r\n        activeEl.selectionEnd\r\n      );\r\n      if (text) return true;\r\n    } else if (window.getSelection) {\r\n      const selection = window.getSelection();\r\n      if (selection.type == \"Range\") {\r\n        const text = selection.toString();\r\n        if (text) return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  let lastTimePressedCtrl = null;\r\n\r\n  function onKeyUp(e) {\r\n    if (twpConfig.get(\"translateSelectedWhenPressTwice\") !== \"yes\") return;\r\n    if (e.key == \"Control\") {\r\n      if (\r\n        lastTimePressedCtrl &&\r\n        performance.now() - lastTimePressedCtrl < 280 &&\r\n        isSelectingText()\r\n      ) {\r\n        lastTimePressedCtrl = performance.now();\r\n        readSelection();\r\n        init();\r\n        translateSelText();\r\n      }\r\n      lastTimePressedCtrl = performance.now();\r\n    }\r\n  }\r\n\r\n  document.addEventListener(\"keyup\", onKeyUp);\r\n\r\n  let windowIsInFocus = true;\r\n  window.addEventListener(\"focus\", function (e) {\r\n    windowIsInFocus = true;\r\n    chrome.runtime.sendMessage(\r\n      { action: \"thisFrameIsInFocus\" },\r\n      checkedLastError\r\n    );\r\n  });\r\n  window.addEventListener(\"blur\", function (e) {\r\n    windowIsInFocus = false;\r\n  });\r\n\r\n  window.addEventListener(\"beforeunload\", function (e) {\r\n    destroy();\r\n  });\r\n\r\n  function updateEventListener() {\r\n    if (\r\n      showTranslateSelectedButton == \"yes\" &&\r\n      (awaysTranslateThisSite ||\r\n        (translateThisSite && translateThisLanguage)) &&\r\n      ((dontShowIfPageLangIsTargetLang == \"yes\" &&\r\n        originalTabLanguage !== currentTargetLanguage) ||\r\n        dontShowIfPageLangIsTargetLang != \"yes\") &&\r\n      ((dontShowIfPageLangIsUnknown == \"yes\" &&\r\n        originalTabLanguage !== \"und\") ||\r\n        dontShowIfPageLangIsUnknown != \"yes\")\r\n    ) {\r\n      document.addEventListener(\"mouseup\", onMouseup);\r\n\r\n      document.addEventListener(\"blur\", destroyIfButtonIsShowing);\r\n      document.addEventListener(\"visibilitychange\", destroyIfButtonIsShowing);\r\n\r\n      document.addEventListener(\"keydown\", destroyIfButtonIsShowing);\r\n      document.addEventListener(\"mousedown\", destroyIfButtonIsShowing);\r\n      document.addEventListener(\"wheel\", destroyIfButtonIsShowing);\r\n\r\n      if (platformInfo.isMobile.any) {\r\n        document.addEventListener(\"touchend\", onTouchend);\r\n        document.addEventListener(\"selectionchange\", onSelectionchange);\r\n      }\r\n    } else {\r\n      document.removeEventListener(\"mouseup\", onMouseup);\r\n\r\n      document.removeEventListener(\"blur\", destroyIfButtonIsShowing);\r\n      document.removeEventListener(\r\n        \"visibilitychange\",\r\n        destroyIfButtonIsShowing\r\n      );\r\n\r\n      document.removeEventListener(\"keydown\", destroyIfButtonIsShowing);\r\n      document.removeEventListener(\"mousedown\", destroyIfButtonIsShowing);\r\n      document.removeEventListener(\"wheel\", destroyIfButtonIsShowing);\r\n\r\n      if (platformInfo.isMobile.any) {\r\n        document.removeEventListener(\"touchend\", onTouchend);\r\n        document.removeEventListener(\"selectionchange\", onSelectionchange);\r\n      }\r\n    }\r\n  }\r\n\r\n  updateEventListener();\r\n\r\n  chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\r\n    if (request.action === \"TranslateSelectedText\") {\r\n      readSelection();\r\n      init();\r\n      translateSelText();\r\n    } else if (request.action === \"anotherFrameIsInFocus\") {\r\n      if (!windowIsInFocus) {\r\n        destroy();\r\n      }\r\n    } else if (request.action === \"hotTranslateSelectedText\") {\r\n      readSelection();\r\n      const prevSelInfo = gSelectionInfo;\r\n      if (\r\n        !prevSelInfo?.element?.focus &&\r\n        !prevSelInfo?.element?.parentNode?.focus\r\n      )\r\n        return;\r\n      if (prevSelInfo.isInputElement && prevSelInfo.readOnly) return;\r\n      if (prevSelInfo.text) {\r\n        backgroundTranslateSingleText(\r\n          currentTextTranslatorService,\r\n          currentTargetLanguage,\r\n          prevSelInfo.text\r\n        ).then((result) => {\r\n          if (!result) return;\r\n          destroy();\r\n          if (prevSelInfo.element.nodeType === 3) {\r\n            prevSelInfo.element.parentNode.focus();\r\n          } else {\r\n            prevSelInfo.element.focus();\r\n          }\r\n          document.execCommand(\"selectAll\", false);\r\n          if (prevSelInfo.isInputElement) {\r\n            prevSelInfo.element.setSelectionRange(\r\n              prevSelInfo.selStart,\r\n              prevSelInfo.selEnd\r\n            );\r\n          } else if (prevSelInfo.isContentEditable) {\r\n            const selection = window.getSelection();\r\n            selection.removeAllRanges();\r\n            selection.addRange(prevSelInfo.range);\r\n          }\r\n          document.execCommand(\"insertText\", false, result);\r\n        });\r\n      }\r\n    }\r\n  });\r\n});\r\n"],"mappings":"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G,SAAS,GAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;IAEL,MAAMC,IAAI,GAAGzC,QAAQ,CAACkC,aAAa,CAAC,MAAM,CAAC;IAC3CO,IAAI,CAACC,YAAY,CAAC,KAAK,EAAE,YAAY,CAAC;IACtCD,IAAI,CAACC,YAAY,CACf,MAAM,EACNjH,MAAM,CAACC,OAAO,CAACiH,MAAM,CAAC,0CAA0C,CAAC,CAClE;IACDb,WAAW,GAAG,KAAK;IACnBW,IAAI,CAACG,MAAM,GAAIlD,CAAC,IAAK;MACnBoC,WAAW,GAAG,IAAI;MAClB,IAAID,SAAS,EAAEA,SAAS,EAAE;IAC5B,CAAC;IACDQ,UAAU,CAACQ,WAAW,CAACJ,IAAI,CAAC;IAE5B,MAAMK,QAAQ,GAAG9C,QAAQ,CAACkC,aAAa,CAAC,OAAO,CAAC;IAChDY,QAAQ,CAACvB,WAAW,GAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;IACCc,UAAU,CAACQ,WAAW,CAACC,QAAQ,CAAC;IAEhC7D,WAAW,CACToD,UAAU,CAACU,cAAc,CAAC,YAAY,CAAC,EACvCV,UAAU,CAACU,cAAc,CAAC,MAAM,CAAC,CAClC;IAED,MAAMC,SAAS,GAAGC,SAAS,CAACC,SAAS,CAACC,WAAW,EAAE,CAAChG,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;IAE3E,IAAIiG,GAAG,CAACC,QAAQ,CAAC,4BAA4B,CAAC,IAAI,CAACL,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"}