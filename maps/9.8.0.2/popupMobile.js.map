{"version":3,"file":"../../contentScript/popupMobile.js","names":["popupMobile","getTabHostName","Promise","resolve","chrome","runtime","sendMessage","action","result","checkedLastError","all","twpConfig","onReady","then","_","tabHostName","platformInfo","isMobile","any","htmlMobile","getURL","originalTabLanguage","currentTargetLanguage","get","currentPageTranslatorService","awaysTranslateThisSite","indexOf","translateThisSite","translateThisLanguage","showPopupMobile","onChanged","name","newValue","show","divElement","getElemById","hideMenu","e","target","style","display","pageLanguageState","pageTranslator","onPageLanguageStateChange","_pageLanguageState","forceShow","hide","document","createElement","classList","add","shadowRoot","attachShadow","mode","innerHTML","body","appendChild","twpI18n","translateDocument","enableDarkMode","getElementById","el","setAttribute","textContent","disableDarkMode","remove","matchMedia","matches","bind","color","translatePage","targetLanguage","setTargetLanguage","langs","twpLang","getLanguageList","langsSorted","i","push","sort","a","b","localeCompare","menuSelectLanguage","forEach","value","addEventListener","stopPropagation","updateIcon","src","onclick","swapPageTranslationService","swapTranslationService","restorePage","set","getMessage","addSiteToNeverTranslate","addLangToNeverTranslate","preventDefault","removeEventListener","window","touches","length","onMessage","addListener","request","sender","sendResponse","onGetOriginalTabLanguage","tabLanguage","lang","fixTLanguageCode","documentElement"],"sources":["popupMobile.js"],"sourcesContent":["\"use strict\";\r\n\r\nvar popupMobile = {};\r\n\r\nfunction getTabHostName() {\r\n  return new Promise((resolve) =>\r\n    chrome.runtime.sendMessage({ action: \"getTabHostName\" }, (result) => {\r\n      checkedLastError();\r\n      resolve(result);\r\n    })\r\n  );\r\n}\r\n\r\nPromise.all([twpConfig.onReady(), getTabHostName()]).then(function (_) {\r\n  const tabHostName = _[1];\r\n  if (!platformInfo.isMobile.any) return;\r\n\r\n  const htmlMobile = `\r\n    <link rel=\"stylesheet\" href=\"${chrome.runtime.getURL(\r\n      \"/contentScript/css/popupMobile.css\"\r\n    )}\">\r\n    \r\n    <div id='element'>\r\n    <div id='main'>\r\n        <img id=\"iconTranslate\">\r\n        <button id=\"btnOriginal\" class=\"item button\" data-i18n=\"btnMobileOriginal\">Original</button>\r\n        <button id=\"btnTranslate\" class=\"item button\" data-i18n=\"btnMobileTranslated\">Translated</button>\r\n        <button id=\"spin\" class=\"item button\">\r\n            <div class=\"loader button\"></div>\r\n        </button>\r\n        <button id=\"btnMenu\" class=\"item2\">\r\n            <div class=\"dropup\">\r\n                <div id=\"menu\" class=\"dropup-content\">\r\n                    <a id=\"btnChangeLanguages\" data-i18n=\"msgChooseAnotherLanguage\">Choose another language</a>\r\n                    <a id=\"btnTranslateSelectedText\" data-i18n=\"msgTranslateSelectedText\">Translate selected text</a>\r\n                    <a id=\"btnNeverTranslate\" data-i18n=\"btnNeverTranslate\">Never translate this site</a>\r\n                    <a id=\"neverTranslateThisLanguage\" data-i18n=\"btnNeverTranslateThisLanguage\" display=\"none\">Never translate this language</a>\r\n                    <a id=\"btnMoreOptions\" data-i18n=\"btnMoreOptions\">More options</a>\r\n                    <a id=\"btnDonate\" data-i18n=\"btnDonate\" href=\"https://www.patreon.com/filipeps\" target=\"_blank\" rel=\"noopener noreferrer\">Donate</a>\r\n                </div>\r\n            </div>\r\n            <div class=\"dropup\">\r\n                <div id=\"menuSelectLanguage\" class=\"dropup-content\"></div>\r\n            </div>\r\n            <div class=\"menuDot\"></div>\r\n            <div class=\"menuDot\"></div>\r\n            <div class=\"menuDot\"></div>\r\n        </button>\r\n        <button id=\"btnClose\" class=\"item\">&times;</button>\r\n    </div>\r\n    </div>\r\n    `;\r\n\r\n  let originalTabLanguage = \"und\";\r\n  let currentTargetLanguage = twpConfig.get(\"targetLanguage\");\r\n  let currentPageTranslatorService = twpConfig.get(\"pageTranslatorService\");\r\n  let awaysTranslateThisSite =\r\n    twpConfig.get(\"alwaysTranslateSites\").indexOf(tabHostName) !== -1;\r\n  let translateThisSite =\r\n    twpConfig.get(\"neverTranslateSites\").indexOf(tabHostName) === -1;\r\n  let translateThisLanguage = false;\r\n  let showPopupMobile = twpConfig.get(\"showPopupMobile\");\r\n\r\n  twpConfig.onChanged(function (name, newValue) {\r\n    switch (name) {\r\n      case \"alwaysTranslateSites\":\r\n        awaysTranslateThisSite = newValue.indexOf(tabHostName) !== -1;\r\n        popupMobile.show();\r\n        break;\r\n      case \"neverTranslateSites\":\r\n        translateThisSite = newValue.indexOf(tabHostName) === -1;\r\n        popupMobile.show();\r\n        break;\r\n      case \"neverTranslateLangs\":\r\n        translateThisLanguage =\r\n          originalTabLanguage === \"und\" ||\r\n          (currentTargetLanguage !== originalTabLanguage &&\r\n            newValue.indexOf(originalTabLanguage) === -1);\r\n        popupMobile.show();\r\n        break;\r\n      case \"showPopupMobile\":\r\n        showPopupMobile = newValue;\r\n        popupMobile.show();\r\n        break;\r\n    }\r\n  });\r\n\r\n  let divElement;\r\n  let getElemById;\r\n\r\n  function hideMenu(e) {\r\n    if (!divElement) return;\r\n    if (e.target === divElement) return;\r\n\r\n    getElemById(\"menuSelectLanguage\").style.display = \"none\";\r\n    getElemById(\"menu\").style.display = \"none\";\r\n  }\r\n\r\n  let pageLanguageState = \"original\";\r\n  pageTranslator.onPageLanguageStateChange((_pageLanguageState) => {\r\n    pageLanguageState = _pageLanguageState;\r\n  });\r\n\r\n  popupMobile.show = function (forceShow = false) {\r\n    popupMobile.hide();\r\n\r\n    if (\r\n      !forceShow &&\r\n      ((!awaysTranslateThisSite &&\r\n        (!translateThisSite || !translateThisLanguage)) ||\r\n        showPopupMobile !== \"yes\")\r\n    )\r\n      return;\r\n\r\n    divElement = document.createElement(\"div\");\r\n    divElement.style = \"all: initial\";\r\n    divElement.classList.add(\"notranslate\");\r\n\r\n    const shadowRoot = divElement.attachShadow({\r\n      mode: \"closed\",\r\n    });\r\n    shadowRoot.innerHTML = htmlMobile;\r\n\r\n    document.body.appendChild(divElement);\r\n\r\n    twpI18n.translateDocument(shadowRoot);\r\n\r\n    function enableDarkMode() {\r\n      if (!shadowRoot.getElementById(\"darkModeElement\")) {\r\n        const el = document.createElement(\"style\");\r\n        el.setAttribute(\"id\", \"darkModeElement\");\r\n        el.setAttribute(\"rel\", \"stylesheet\");\r\n        el.textContent = `\r\n                div, button, select, option {\r\n                    color: rgb(231, 230, 228);\r\n                    background-color: #181a1b !important;\r\n                }\r\n            \r\n                a {\r\n                    color: rgb(231, 230, 228) !important;\r\n                    background-color: #181a1b;\r\n                }\r\n            \r\n                .dropup-content a:hover {\r\n                    background-color: #454a4d;\r\n                }\r\n            \r\n                .menuDot {\r\n                    background-color: rgb(231, 230, 228) !important;\r\n                }\r\n                `;\r\n        shadowRoot.appendChild(el);\r\n      }\r\n    }\r\n\r\n    function disableDarkMode() {\r\n      if (shadowRoot.getElementById(\"#darkModeElement\")) {\r\n        shadowRoot.getElementById(\"#darkModeElement\").remove();\r\n      }\r\n    }\r\n\r\n    switch (twpConfig.get(\"darkMode\")) {\r\n      case \"auto\":\r\n        if (matchMedia(\"(prefers-color-scheme: dark)\").matches) {\r\n          enableDarkMode();\r\n        } else {\r\n          disableDarkMode();\r\n        }\r\n        break;\r\n      case \"yes\":\r\n        enableDarkMode();\r\n        break;\r\n      case \"no\":\r\n        disableDarkMode();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    getElemById = shadowRoot.getElementById.bind(shadowRoot);\r\n\r\n    if (pageLanguageState === \"original\") {\r\n      getElemById(\"btnOriginal\").style.color = \"#2196F3\";\r\n      getElemById(\"btnTranslate\").style.color = null;\r\n    } else {\r\n      getElemById(\"btnOriginal\").style.color = null;\r\n      getElemById(\"btnTranslate\").style.color = \"#2196F3\";\r\n    }\r\n\r\n    function translatePage(targetLanguage = currentTargetLanguage) {\r\n      getElemById(\"menuSelectLanguage\").style.display = \"none\";\r\n      getElemById(\"menu\").style.display = \"none\";\r\n\r\n      if (targetLanguage !== currentTargetLanguage) {\r\n        currentTargetLanguage = targetLanguage;\r\n        twpConfig.setTargetLanguage(targetLanguage, true);\r\n      }\r\n      pageTranslator.translatePage(targetLanguage);\r\n\r\n      getElemById(\"btnOriginal\").style.color = null;\r\n      getElemById(\"btnTranslate\").style.color = \"#2196F3\";\r\n    }\r\n\r\n    // fill language list\r\n    (function () {\r\n      let langs = twpLang.getLanguageList();\r\n\r\n      const langsSorted = [];\r\n\r\n      for (const i in langs) {\r\n        langsSorted.push([i, langs[i]]);\r\n      }\r\n\r\n      langsSorted.sort(function (a, b) {\r\n        return a[1].localeCompare(b[1]);\r\n      });\r\n\r\n      const menuSelectLanguage = getElemById(\"menuSelectLanguage\");\r\n      langsSorted.forEach((value) => {\r\n        const a = document.createElement(\"a\");\r\n        a.setAttribute(\"value\", value[0]);\r\n        a.textContent = value[1];\r\n        a.addEventListener(\"click\", (e) => {\r\n          e.stopPropagation();\r\n          translatePage(value[0]);\r\n        });\r\n        menuSelectLanguage.appendChild(a);\r\n      });\r\n    })();\r\n\r\n    function updateIcon() {\r\n      if (!getElemById) return;\r\n\r\n      if (currentPageTranslatorService === \"yandex\") {\r\n        getElemById(\"iconTranslate\").src = chrome.runtime.getURL(\r\n          \"/icons/yandex-translate-32.png\"\r\n        );\r\n      } else if (currentPageTranslatorService === \"bing\") {\r\n        getElemById(\"iconTranslate\").src = chrome.runtime.getURL(\r\n          \"/icons/bing-translate-32.png\"\r\n        );\r\n      } else {\r\n        getElemById(\"iconTranslate\").src = chrome.runtime.getURL(\r\n          \"/icons/google-translate-32.png\"\r\n        );\r\n      }\r\n    }\r\n    updateIcon();\r\n\r\n    getElemById(\"iconTranslate\").onclick = (e) => {\r\n      currentPageTranslatorService = twpConfig.swapPageTranslationService();\r\n\r\n      pageTranslator.swapTranslationService(currentPageTranslatorService);\r\n      updateIcon();\r\n    };\r\n\r\n    getElemById(\"btnOriginal\").onclick = (e) => {\r\n      pageTranslator.restorePage();\r\n      if (!getElemById) return;\r\n\r\n      getElemById(\"btnOriginal\").style.color = \"#2196F3\";\r\n      getElemById(\"btnTranslate\").style.color = null;\r\n    };\r\n\r\n    getElemById(\"btnTranslate\").onclick = (e) => {\r\n      translatePage();\r\n    };\r\n\r\n    getElemById(\"btnMenu\").onclick = (e) => {\r\n      if (!getElemById) return;\r\n      if (getElemById(\"menu\").style.display === \"block\") {\r\n        getElemById(\"menu\").style.display = \"none\";\r\n      } else {\r\n        getElemById(\"menu\").style.display = \"block\";\r\n      }\r\n      getElemById(\"menuSelectLanguage\").style.display = \"none\";\r\n    };\r\n\r\n    getElemById(\"btnClose\").onclick = (e) => {\r\n      popupMobile.hide();\r\n    };\r\n\r\n    getElemById(\"btnChangeLanguages\").onclick = (e) => {\r\n      e.stopPropagation();\r\n      if (!getElemById) return;\r\n      getElemById(\"menuSelectLanguage\").style.display = \"block\";\r\n      getElemById(\"menu\").style.display = \"none\";\r\n    };\r\n\r\n    getElemById(\"btnTranslateSelectedText\").onclick = (e) => {\r\n      if (twpConfig.get(\"showTranslateSelectedButton\") === \"yes\") {\r\n        twpConfig.set(\"showTranslateSelectedButton\", \"no\");\r\n        getElemById(\"btnTranslateSelectedText\").textContent =\r\n          twpI18n.getMessage(\"msgTranslateSelectedText\");\r\n      } else {\r\n        twpConfig.set(\"showTranslateSelectedButton\", \"yes\");\r\n        getElemById(\"btnTranslateSelectedText\").textContent =\r\n          twpI18n.getMessage(\"msgNoTranslateSelectedText\");\r\n      }\r\n      getElemById(\"menu\").style.display = \"none\";\r\n      e.stopPropagation();\r\n    };\r\n\r\n    getElemById(\"btnNeverTranslate\").onclick = (e) => {\r\n      twpConfig.addSiteToNeverTranslate(tabHostName);\r\n      popupMobile.hide();\r\n    };\r\n\r\n    getElemById(\"neverTranslateThisLanguage\").onclick = (e) => {\r\n      twpConfig.addLangToNeverTranslate(originalTabLanguage);\r\n      popupMobile.hide();\r\n    };\r\n\r\n    getElemById(\"btnMoreOptions\").onclick = (e) => {\r\n      chrome.runtime.sendMessage(\r\n        {\r\n          action: \"openOptionsPage\",\r\n        },\r\n        checkedLastError\r\n      );\r\n    };\r\n\r\n    getElemById(\"btnDonate\").onclick = (e) => {\r\n      e.preventDefault();\r\n      chrome.runtime.sendMessage(\r\n        {\r\n          action: \"openDonationPage\",\r\n        },\r\n        checkedLastError\r\n      );\r\n    };\r\n\r\n    document.addEventListener(\"blur\", hideMenu);\r\n    document.addEventListener(\"click\", hideMenu);\r\n\r\n    if (twpConfig.get(\"showTranslateSelectedButton\") === \"yes\") {\r\n      getElemById(\"btnTranslateSelectedText\").textContent =\r\n        twpI18n.getMessage(\"msgNoTranslateSelectedText\");\r\n    } else {\r\n      getElemById(\"btnTranslateSelectedText\").textContent =\r\n        twpI18n.getMessage(\"msgTranslateSelectedText\");\r\n    }\r\n\r\n    getElemById(\"btnDonate\").innerHTML += \" &#10084;\";\r\n  };\r\n\r\n  popupMobile.hide = function () {\r\n    if (!divElement) return;\r\n\r\n    divElement.remove();\r\n    divElement = getElemById = null;\r\n\r\n    document.removeEventListener(\"blur\", hideMenu);\r\n    document.removeEventListener(\"click\", hideMenu);\r\n  };\r\n\r\n  if (showPopupMobile !== \"no\") {\r\n    window.addEventListener(\"touchstart\", (e) => {\r\n      if (e.touches.length == 3) {\r\n        popupMobile.show(true);\r\n      }\r\n    });\r\n  }\r\n\r\n  chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\r\n    if (request.action === \"showPopupMobile\") {\r\n      popupMobile.show(true);\r\n    }\r\n  });\r\n\r\n  pageTranslator.onGetOriginalTabLanguage(function (tabLanguage) {\r\n    if (!tabLanguage || tabLanguage === \"und\") {\r\n      const lang = twpLang.fixTLanguageCode(document.documentElement.lang);\r\n      if (lang) {\r\n        originalTabLanguage = tabLanguage;\r\n      }\r\n    } else {\r\n      originalTabLanguage = tabLanguage;\r\n    }\r\n    translateThisLanguage =\r\n      originalTabLanguage === \"und\" ||\r\n      (currentTargetLanguage !== originalTabLanguage &&\r\n        twpConfig.get(\"neverTranslateLangs\").indexOf(originalTabLanguage) ===\r\n          -1);\r\n    popupMobile.show();\r\n  });\r\n\r\n  /*\r\n    const dpr = 1\r\n    const origInnerWidth = window.innerWidth * window.devicePixelRatio\r\n    console.log(origInnerWidth)\r\n    const el = iframeDiv\r\n\r\n    function f() {\r\n        el.style.scale = dpr / window.devicePixelRatio\r\n        el.style.width = ( 100 / (dpr / window.devicePixelRatio) ) + \"%\"\r\n        el.style.left = \"0px\"\r\n        el.style.bottom = \"0px\"\r\n\r\n        const eWidth = parseFloat(window.innerWidth)\r\n\r\n        const dX = (eWidth * window.devicePixelRatio - eWidth) / 2\r\n        const dY = ((50 * (window.devicePixelRatio)) - 50) / (window.devicePixelRatio * 2)\r\n        console.log({\r\n            scale: dpr / window.devicePixelRatio,\r\n            dpr: dpr,\r\n            devicePixelRatio: devicePixelRatio,\r\n            elWidth: getComputedStyle(el).width,\r\n            dx: dX\r\n        })\r\n        el.style.left = - (origInnerWidth - innerWidth) / 2 + \"px\"\r\n        el.style.bottom = -dY + \"px\" \r\n    }\r\n    let oldwidth = null\r\n\r\n    function foo() {\r\n        if (oldwidth) {\r\n            if (oldwidth != window.innerWidth) {\r\n                f()\r\n            }\r\n            oldwidth = window.innerWidth\r\n        } else {\r\n            oldwidth = window.innerWidth\r\n            f()\r\n        }\r\n        requestAnimationFrame(foo)\r\n    }\r\n    requestAnimationFrame(foo)\r\n    //*/\r\n});\r\n"],"mappings":"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"}